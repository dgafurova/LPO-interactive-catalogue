(function(){"use strict";var t={601:function(t,e,a){var i=a(751),o=a(641);function l(t,e,a,i,l,r){const n=(0,o.g2)("headerOfPage"),s=(0,o.g2)("router-view");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(n),(0,o.bF)(s)],64)}const r={class:"container"},n={class:"logo-container"},s=["src"],d={class:"links"};function c(t,e,a,i,l,c){const u=(0,o.g2)("router-link");return(0,o.uX)(),(0,o.CE)("nav",null,[(0,o.Lk)("div",r,[(0,o.Lk)("div",n,[(0,o.Lk)("img",{src:i.logo,alt:"Logo",class:"logo-image"},null,8,s),e[0]||(e[0]=(0,o.Lk)("div",{class:"logo-text"},[(0,o.Lk)("p",null,"Интерактивный каталог"),(0,o.Lk)("p",null,"орбит вокруг точек либрации")],-1))]),(0,o.Lk)("div",d,[(0,o.bF)(u,{to:"/"},{default:(0,o.k6)((()=>e[1]||(e[1]=[(0,o.Lk)("p",{class:"link"},"Просмотр карты",-1)]))),_:1}),(0,o.bF)(u,{to:"/build"},{default:(0,o.k6)((()=>e[2]||(e[2]=[(0,o.Lk)("p",{class:"link"},"Построение графиков",-1)]))),_:1})])])])}var u=a.p+"img/logo.b9ced963.svg",p={setup(){return{logo:u}}},h=a(262);const m=(0,h.A)(p,[["render",c],["__scopeId","data-v-bb822bd0"]]);var b=m,f={components:{headerOfPage:b},data(){return{}}};const v=(0,h.A)(f,[["render",l]]);var y=v,L=a(723);(0,L.k)("/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(t){console.error("Error during service worker registration:",t)}});var g=a(220);const P={class:"container-main"};function k(t,e,a,i,l,r){const n=(0,o.g2)("system-selection"),s=(0,o.g2)("selection-by-conditions"),d=(0,o.g2)("MapImg"),c=(0,o.g2)("OrbitInformation");return(0,o.uX)(),(0,o.CE)("div",P,[(0,o.bF)(n,{"onUpdate:selectedSystem":r.updateSelectedSystemId},null,8,["onUpdate:selectedSystem"]),(0,o.bF)(s,{"selected-system-id":l.selectedSystemId,onFilterApplied:r.updateMapData},null,8,["selected-system-id","onFilterApplied"]),1==t.selectedOrbit?((0,o.uX)(),(0,o.Wv)(d,{key:0,ref:"MapImg",onOrbitApplied:r.updateOrbitInfo},null,8,["onOrbitApplied"])):(0,o.Q3)("",!0),t.informationOrbit?((0,o.uX)(),(0,o.Wv)(c,{key:1,ref:"OrbitInformation"},null,512)):(0,o.Q3)("",!0)])}var x=a(33);const O={class:"container"},F={key:0,class:"loading-message"},I={key:1},C={key:0},X={id:"plotly-chart",ref:"plotlyChart"},w={class:"info"},j={key:0},$={key:1,class:"no-orbits-message"};function z(t,e,a,i,l,r){return(0,o.uX)(),(0,o.CE)("div",O,[e[4]||(e[4]=(0,o.Lk)("h2",null,"Карта начальных условий",-1)),l.isLoading?((0,o.uX)(),(0,o.CE)("div",F,e[1]||(e[1]=[(0,o.Lk)("div",{class:"spinner"},null,-1),(0,o.Lk)("p",null,"Загрузка...",-1)]))):((0,o.uX)(),(0,o.CE)("div",I,[l.noOrbitsFound?((0,o.uX)(),(0,o.CE)("div",$,e[3]||(e[3]=[(0,o.Lk)("p",null,"К сожалению, орбиты с такими параметрами не найдены.",-1)]))):((0,o.uX)(),(0,o.CE)("div",C,[(0,o.Lk)("div",X,null,512),(0,o.Lk)("div",w,[null===l.selectedX||null===l.selectedZ||l.isLoading?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("p",j,[(0,o.eW)(" Выбранный X = "+(0,x.v_)((1e3*l.selectedX).toFixed(3)),1),e[2]||(e[2]=(0,o.Lk)("br",null,null,-1)),(0,o.eW)(" Выбранный Z = "+(0,x.v_)((1e3*l.selectedZ).toFixed(3)),1)])),null===l.selectedX||null===l.selectedZ||l.isLoading?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("button",{key:1,onClick:e[0]||(e[0]=(...t)=>r.applyOrbit&&r.applyOrbit(...t)),class:"orbit-button"}," Показать информацию об орбите "))])]))]))])}var D=a(708),N=a.n(D),E=a(278),S={data(){return{selectedX:null,selectedZ:null,noOrbitsFound:!1,isLoading:!1,isFetching:!1,isFetchingAll:!1,isFetchingSelected:!1,initialized:!1,selectedTraceIndex:null}},computed:{...(0,E.aH)(["filters","allOrbitsData","selectedOrbitsData","orbitId"]),...(0,E.L8)(["getOrbitData"])},watch:{orbitId(t){this.initialized&&this.updateHighlightOrbit(t)},selectedOrbitsData(){this.$nextTick((()=>{this.plotData(this.allOrbitsData,this.selectedOrbitsData.data)}))}},mounted(){console.log("MapImg компонент смонтирован"),this.$nextTick((()=>{this.isLoading=!0,setTimeout((()=>{this.fetchOrbits()}),10)}))},beforeUnmount(){const t=this.$refs.plotlyChart;t&&t.removeAllListeners("plotly_click")},methods:{...(0,E.i0)(["updateOrbitId"]),...(0,E.PY)(["setAllOrbitsData","setSelectedOrbitsData","infoOrbit","resetInformationOrbit"]),applyOrbit(){null!==this.selectedX&&null!==this.selectedZ?(this.infoOrbit(),this.$emit("orbit-applied",{x:this.selectedX,z:this.selectedZ})):console.error("No orbit is selected.")},async fetchOrbits(){if(this.isFetchingAll||this.isFetchingSelected)console.log("fetchOrbits уже выполняется");else{this.isFetchingAll=!0,this.isFetchingSelected=!0,this.isLoading=!0,this.initialized=!1,console.log("fetchOrbits вызван - Начало выполнения");try{if(this.allOrbitsData&&0!==this.allOrbitsData.length)console.log("Используются кэшированные данные всех орбит");else{const t=await fetch("https://orbital-catalog.auditory.ru/api/v1/orbits/map");if(!t.ok)throw new Error("Failed to fetch all orbits data");const e=await t.json();console.log("All Data:",e),this.setAllOrbitsData(e)}const t=new URLSearchParams,{amplitudeX:e,period:a,amplitudeY:i,jacobiConstant:o,amplitudeZ:l,family:r}=this.filters;a?.from&&t.append("t_min",Number(a.from)),a?.to&&t.append("t_max",Number(a.to)),e?.from&&t.append("ax_min",Number(e.from)),e?.to&&t.append("ax_max",Number(e.to)),i?.from&&t.append("ay_min",Number(i.from)),i?.to&&t.append("ay_max",Number(i.to)),l?.from&&t.append("az_min",Number(l.from)),l?.to&&t.append("az_max",Number(l.to)),o?.from&&t.append("cj_min",Number(o.from)),o?.to&&t.append("cj_max",Number(o.to)),r?.trim()&&t.append("tag",r.trim());const n=t.toString();if(this.selectedOrbitsData&&this.selectedOrbitsData.queryString===n&&this.selectedOrbitsData.data.length>0)console.log("Используются кэшированные данные выбранных орбит");else{const t=n?`https://orbital-catalog.auditory.ru/api/v1/orbits/map?${n}`:"https://orbital-catalog.auditory.ru/api/v1/orbits/map";console.log("URL выбранных орбит:",t);const e=await fetch(t);if(!e.ok)throw new Error("Failed to fetch selected orbits data");const a=await e.json();console.log("Selected Data:",a),this.setSelectedOrbitsData({data:a,queryString:n})}this.noOrbitsFound=!this.selectedOrbitsData||0===this.selectedOrbitsData.data.length}catch(t){console.error("Error fetching orbits data:",t),this.noOrbitsFound=!0,this.selectedX=null,this.selectedZ=null,this.resetInformationOrbit(),this.updateOrbitId(null)}finally{this.isFetchingAll=!1,this.isFetchingSelected=!1,this.isLoading=!1,console.log("fetchOrbits завершен - isFetchingAll:",this.isFetchingAll,", isFetchingSelected:",this.isFetchingSelected),this.$nextTick((()=>{this.plotData(this.allOrbitsData,this.selectedOrbitsData?this.selectedOrbitsData.data:[])}))}}},plotData(t=[],e=[]){if(console.log("Plotting Data:",{allData:t.length,selectedData:e.length}),!t.length)return this.noOrbitsFound=!0,this.selectedX=null,this.selectedZ=null,void this.resetInformationOrbit();const a=this.$refs.plotlyChart;console.log("Plotly Chart Element:",a),a?this.initialized?(this.updateHighlightOrbit(this.orbitId),console.log("Chart updated with highlight")):(this.initializeChart(t,e),this.initialized=!0,console.log("Chart initialized")):console.error("No DOM element with ref 'plotlyChart' exists on the page."),this.orbitId&&this.updateHighlightOrbit(this.orbitId)},initializeChart(t,e){const a=this.$refs.plotlyChart;if(!a)return void console.error("Element with ref 'plotlyChart' not found.");const i=e.filter((t=>12103===t.id)),o=e.filter((t=>12103!==t.id)),l=t.map((t=>parseFloat(t["x"]))).filter((t=>!isNaN(t))),r=t.map((t=>parseFloat(t["z"]))).filter((t=>!isNaN(t))),n=l.map((t=>t/1e3)),s=r.map((t=>t/1e3)),d={x:n,y:s,mode:"markers",marker:{size:2,color:"rgba(128, 128, 128, 0.5)"},hoverinfo:"none",showlegend:!1,type:"scatter",name:"Все орбиты"},c=o.map((t=>parseFloat(t["x"]))).filter((t=>!isNaN(t))),u=o.map((t=>parseFloat(t["z"]))).filter((t=>!isNaN(t))),p=o.map((t=>parseFloat(t["v"]))).filter((t=>!isNaN(t))),h=o.map((t=>t.id)),m={x:c.map((t=>t/1e3)),y:u.map((t=>t/1e3)),mode:"markers",marker:{size:3,color:p,colorscale:"Jet",showscale:!0,colorbar:{title:{text:"V, км/с",side:"right"}}},hoverinfo:"text",text:c.map(((t,e)=>`X: ${t.toFixed(3)} км<br>Z: ${u[e].toFixed(3)} км<br>V: ${p[e].toFixed(3)} км/с`)),customdata:h,showlegend:!1,type:"scatter",name:"Отобранные орбиты"},b=i.map((t=>parseFloat(t["x"]))).filter((t=>!isNaN(t))),f=i.map((t=>parseFloat(t["z"]))).filter((t=>!isNaN(t))),v=i.map((t=>parseFloat(t["v"]))).filter((t=>!isNaN(t))),y=i.map((t=>t.id)),L={x:b.map((t=>t/1e3)),y:f.map((t=>t/1e3)),mode:"markers",marker:{size:3,color:v,colorscale:"Jet",showscale:!1,opacity:.3},hoverinfo:"text",text:b.map(((t,e)=>`X: ${t.toFixed(3)} км<br>Z: ${f[e].toFixed(3)} км<br>V: ${v[e].toFixed(3)} км/с`)),customdata:y,showlegend:!1,type:"scatter",name:"Отобранные орбиты (тусклые)"},g={x:[],y:[],mode:"markers",marker:{size:10,color:"red",symbol:"star"},text:[],showlegend:!1,name:"Выбранная орбита",type:"scatter"},P={xaxis:{title:{text:"X, 10³ км",standoff:10}},yaxis:{title:{text:"Z, 10³ км",standoff:10}},hovermode:"closest"};N().newPlot(a,[d,m,L,g],P),a.on("plotly_click",this.handlePlotlyClick),this.orbitId&&this.updateHighlightOrbit(this.orbitId)},handlePlotlyClick(t){const e=t.points[0],a=e.customdata;if(a){const t=this.selectedOrbitsData.data.find((t=>t.id===a));t?(this.selectedX=parseFloat(t.x)/1e3,this.selectedZ=parseFloat(t.z)/1e3,this.updateOrbitId(t.id)):console.warn(`Orbit with id ${a} not found in selected data.`)}else console.warn("No orbitId found in clicked point.")},updateHighlightOrbit(t){const e=this.$refs.plotlyChart;if(!e||!e.data)return;if(!t)return N().restyle(e,{x:[[]],y:[[]],text:[[]]},[3]),this.selectedX=null,void(this.selectedZ=null);let a=this.selectedOrbitsData.data.find((e=>e.id===t));if(a||(console.warn(`Orbit with id ${t} not found in selected data, searching in all data.`),a=this.allOrbitsData.find((e=>e.id===t))),a){this.selectedX=parseFloat(a.x)/1e3,this.selectedZ=parseFloat(a.z)/1e3;const i=parseFloat(a.v);N().restyle(e,{x:[[this.selectedX]],y:[[this.selectedZ]],text:[[`X: ${(1e3*this.selectedX).toFixed(3)} км<br>Z: ${(1e3*this.selectedZ).toFixed(3)} км<br>V: ${i.toFixed(3)} км/с`]],hovertemplate:"%{text}<extra></extra>"},[3]),N().restyle(e,{"marker.size":[[12]],"marker.color":[["red"]],"marker.symbol":[["star"]]},[3]),console.log(`Highlight updated to orbitId: ${t}`)}else console.warn(`Orbit with id ${t} not found in all data.`)}}};const Y=(0,h.A)(S,[["render",z],["__scopeId","data-v-ad5adbc0"]]);var T=Y;const V={class:"container"},_={key:0,class:"loading-message"},A={key:1,class:"container"},U={class:"info"},M={key:0,class:"min-container"},H={class:"point"},Z={class:"point"},B={class:"point"},q={class:"point"},G={class:"point"},J={class:"point"},R={class:"point"},Q={key:1,class:"no-orbits-message"},W={class:"info-2"},K={key:0,class:"csv"},tt={key:1,class:"no-orbits-message"};function et(t,e,a,i,l,r){const n=(0,o.g2)("PlotlyCsv3d");return(0,o.uX)(),(0,o.CE)("div",V,[l.isLoading?((0,o.uX)(),(0,o.CE)("div",_,e[1]||(e[1]=[(0,o.Lk)("div",{class:"spinner"},null,-1),(0,o.Lk)("p",null,"Загрузка данных орбиты...",-1)]))):((0,o.uX)(),(0,o.CE)("div",A,[(0,o.Lk)("div",U,[e[10]||(e[10]=(0,o.Lk)("h3",null,"Информация об орбите",-1)),l.noOrbitInfoFound?((0,o.uX)(),(0,o.CE)("div",Q,e[9]||(e[9]=[(0,o.Lk)("p",null,"К сожалению, информация об орбите не найдена.",-1)]))):((0,o.uX)(),(0,o.CE)("div",M,[(0,o.Lk)("div",H,[e[2]||(e[2]=(0,o.Lk)("p",null,"Период (дни)",-1)),(0,o.Lk)("p",null,(0,x.v_)(r.displayPeriod),1)]),(0,o.Lk)("div",Z,[e[3]||(e[3]=(0,o.Lk)("p",null,"Амплитуда по x (км)",-1)),(0,o.Lk)("p",null,(0,x.v_)(l.amplitudeX),1)]),(0,o.Lk)("div",B,[e[4]||(e[4]=(0,o.Lk)("p",null,"Амплитуда по y (км)",-1)),(0,o.Lk)("p",null,(0,x.v_)(l.amplitudeY),1)]),(0,o.Lk)("div",q,[e[5]||(e[5]=(0,o.Lk)("p",null,"Амплитуда по z (км)",-1)),(0,o.Lk)("p",null,(0,x.v_)(l.amplitudeZ),1)]),(0,o.Lk)("div",G,[e[6]||(e[6]=(0,o.Lk)("p",null,"Значение константы Якоби",-1)),(0,o.Lk)("p",null,(0,x.v_)(l.jacobiConstant),1)]),(0,o.Lk)("div",J,[e[7]||(e[7]=(0,o.Lk)("p",null,"Устойчивость",-1)),(0,o.Lk)("p",null,(0,x.v_)(l.stability),1)]),(0,o.Lk)("div",R,[e[8]||(e[8]=(0,o.Lk)("p",null,"Семейство",-1)),(0,o.Lk)("p",null,(0,x.v_)(l.family),1)])]))]),(0,o.Lk)("div",W,[e[12]||(e[12]=(0,o.Lk)("h3",null,"Визуализация орбиты",-1)),(0,o.Lk)("div",null,[l.noOrbitInfoFound?((0,o.uX)(),(0,o.CE)("div",tt,e[11]||(e[11]=[(0,o.Lk)("p",null,"К сожалению, данные графика орбиты не найдены.",-1)]))):((0,o.uX)(),(0,o.CE)("div",K,[(0,o.bF)(n,{csvData:l.orb4,class:"csv-orb"},null,8,["csvData"]),(0,o.Lk)("button",{onClick:e[0]||(e[0]=(...t)=>r.goToBuildPage&&r.goToBuildPage(...t))}," Построить другие визуализации для данной орбиты ")]))])])]))])}const at=["id"];function it(t,e,a,i,l,r){return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.Lk)("div",{id:l.chartId,class:"plotly-chart"},null,8,at)])}var ot={props:{csvData:{type:Array,required:!0,default:()=>[]},view:{type:String,default:"frontView"},layout:{type:Object,required:!1,default:()=>({xaxis:{title:"X (10³ км)"},yaxis:{title:"Y (10³ км)"},zaxis:{title:"Z (10³ км)"},margin:{l:50,r:50,b:50,t:50},scene:{camera:{eye:{x:1.25,y:1.25,z:1.25}}}})}},data(){return{chartId:`plotly-chart-${Math.random().toString(36).substr(2,9)}`,layouts:{frontView:{scene:{camera:{eye:{x:2,y:0,z:0}}}},sideView:{scene:{camera:{eye:{x:0,y:2,z:0}}}},topView:{scene:{camera:{eye:{x:0,y:0,z:2}}}}}}},mounted(){this.plotData()},watch:{csvData(){this.plotData()},view(t,e){t!==e&&this.plotData()}},methods:{plotData(){if(!this.csvData||0===this.csvData.length)return;const t=this.csvData.map((t=>parseFloat(t.x)/1e3)).filter((t=>!isNaN(t))),e=this.csvData.map((t=>parseFloat(t.y)/1e3)).filter((t=>!isNaN(t))),a=this.csvData.map((t=>parseFloat(t.z)/1e3)).filter((t=>!isNaN(t))),i=this.csvData.map((t=>Math.sqrt(Math.pow(parseFloat(t.vx),2)+Math.pow(parseFloat(t.vy),2)+Math.pow(parseFloat(t.vz),2)))).filter((t=>!isNaN(t))),o=Math.min(...t),l=Math.max(...t),r=Math.min(...e),n=Math.max(...e),s=Math.min(...a),d=Math.max(...a),c=l-o,u=n-r,p=d-s,h=t=>Math.floor(t/4),m={...this.layout,...this.layouts[this.view],scene:{xaxis:{title:"X (10³ км)",tickformat:".3~f",dtick:h(c)},yaxis:{title:"Y (10³ км)",tickformat:".3~f",dtick:h(u)},zaxis:{title:"Z (10³ км)",tickformat:".3~f",dtick:h(p)},camera:{eye:{x:1.25,y:1.25,z:1.25}}},margin:{l:50,r:50,b:50,t:50},showlegend:!0},b=t.map(((t,o)=>`X: ${t.toFixed(3)} 10³км<br>Y: ${e[o].toFixed(3)} 10³км<br>Z: ${a[o].toFixed(3)} 10³км<br>V: ${i[o].toFixed(3)} км/с`)),f=t.map(((t,a)=>`X: ${t.toFixed(3)} 10³км<br>Y: ${e[a].toFixed(3)} 10³км`)),v=t.map(((t,e)=>`X: ${t.toFixed(3)} 10³км<br>Z: ${a[e].toFixed(3)} 10³км`)),y=e.map(((t,e)=>`Y: ${t.toFixed(3)} 10³км<br>Z: ${a[e].toFixed(3)} 10³км`)),L={x:t,y:e,z:a,mode:"lines",line:{color:i,colorscale:"Jet",showscale:!0,width:5,colorbar:{title:{text:"V (км/с)",side:"right"},thickness:10,len:.5}},text:b,hoverinfo:"text",name:"Траектория",type:"scatter3d"},g={x:t,y:e,z:Array(t.length).fill(s-.1*p),mode:"lines",line:{color:"gray",width:3},text:f,hoverinfo:"text",name:"Проекция на XY",type:"scatter3d"},P={x:t,y:Array(e.length).fill(r-.1*u),z:a,mode:"lines",line:{color:"gray",width:3},text:v,hoverinfo:"text",name:"Проекция на XZ",type:"scatter3d"},k={x:Array(t.length).fill(o-.1*c),y:e,z:a,mode:"lines",line:{color:"gray",width:3},text:y,hoverinfo:"text",name:"Проекция на YZ",type:"scatter3d"},x={displayModeBar:!1,responsive:!0};document.getElementById(this.chartId)?N().newPlot(this.chartId,[L,g,P,k],m,x):console.error(`Element with ID ${this.chartId} does not exist.`)}}};const lt=(0,h.A)(ot,[["render",it],["__scopeId","data-v-2ed81291"]]);var rt=lt,nt={components:{PlotlyCsv3d:rt},data(){return{period:null,amplitudeX:null,amplitudeY:null,amplitudeZ:null,jacobiConstant:null,stability:null,family:null,orb4:[],noOrbitInfoFound:!1,isLoading:!1,familyOptions:[{label:"Горизонтальные орбиты Ляпунова, L1",value:"L1.L"},{label:"Горизонтальные орбиты Ляпунова, L2",value:"L2.L"},{label:"Вертикальные орбиты Ляпунова, L1",value:"L1.V"},{label:"Вертикальные орбиты Ляпунова, L2",value:"L2.V"},{label:"Аксиальные орбиты, L1",value:"L1.A"},{label:"Аксиальные орбиты, L2",value:"L2.A"},{label:"Гало орбиты, L1",value:"L1.H"},{label:"Гало орбиты, L2",value:"L2.H"},{label:"Двухпериодические квазигоризонтальные орбиты, L1",value:"L1.L.2P1"},{label:"Двухпериодические квазигоризонтальные орбиты, L2",value:"L2.L.2P1"},{label:"Трехпериодические квазигоризонтальные орбиты, L1",value:"L1.L.3P1"},{label:"Трехпериодические квазигоризонтальные орбиты, L2",value:"L2.L.3P1"},{label:"Четырехпериодические квазигоризонтальные орбиты, L1",value:"L1.L.4P1"},{label:"Четырехпериодические квазигоризонтальные орбиты, L2",value:"L2.L.4P1"},{label:"Четырехпериодические квазигоризонтальные орбиты, L1 (2P1.2P1)",value:"L1.L.2P1.2P1"},{label:"Четырехпериодические квазигоризонтальные орбиты, L2 (2P1.2P1)",value:"L2.L.2P1.2P1"},{label:"Шестипериодические квазигоризонтальные орбиты, L1 (2P1.3P1)",value:"L1.L.2P1.3P1"},{label:"Шестипериодические квазигоризонтальные орбиты, L1 (2P1.3P2)",value:"L1.L.2P1.3P2"},{label:"Шестипериодические квазигоризонтальные орбиты, L2 (2P1.3P1)",value:"L2.L.2P1.3P1"},{label:"Шестипериодические квазигоризонтальные орбиты, L2 (2P1.3P2)",value:"L2.L.2P1.3P2"},{label:"Двухпериодические квазигоризонтальные орбиты, L1 (2P1.Tan)",value:"L1.L.2P1.Tan"},{label:"Двухпериодические квазигоризонтальные орбиты, L2 (2P1.Tan)",value:"L2.L.2P1.Tan"},{label:"Двухпериодические квазигало орбиты, L1 (2P1)",value:"L1.H.2P1"},{label:"Двухпериодические квазигало орбиты, L1 (2P2)",value:"L1.H.2P2"},{label:"Двухпериодические квазигало орбиты, L1 (2P3)",value:"L1.H.2P3"},{label:"Двухпериодические квазигало орбиты, L2 (2P1)",value:"L2.H.2P1"},{label:"Двухпериодические квазигало орбиты, L2 (2P2)",value:"L2.H.2P2"},{label:"Трехпериодические квазигало орбиты, L1 (3P1)",value:"L1.H.3P1"},{label:"Трехпериодические квазигало орбиты, L1 (3P2)",value:"L1.H.3P2"},{label:"Трехпериодические квазигало орбиты, L1 (3P3)",value:"L1.H.3P3"},{label:"Трехпериодические квазигало орбиты, L2 (3P1)",value:"L2.H.3P1"},{label:"Квазипериодические орбиты, L1",value:"L1.Q"},{label:"Четырехпериодические квазигало орбиты, L1",value:"L1.H.4P1"}]}},computed:{...(0,E.L8)(["orbitId"]),displayPeriod(){return-1==this.period?"Орбита квазипериодическая":this.period}},async mounted(){console.log("Orbit ID in OrbitInformation.vue:",this.orbitId),this.orbitId?await this.submit():(console.error("orbitId is not defined"),this.noOrbitInfoFound=!0)},methods:{goToBuildPage(){this.orbitId?this.$router.push("/build"):console.error("Orbit ID is not available.")},async submit(){this.isLoading=!0;try{let t=await fetch(`https://orbital-catalog.auditory.ru/api/v1/orbits/${this.orbitId}`,{method:"GET"});if(!t.ok)throw this.noOrbitInfoFound=!0,new Error("Failed to fetch orbit data");let e=await t.json();if(!e||!e.t)return void(this.noOrbitInfoFound=!0);if(this.noOrbitInfoFound=!1,this.period=null!=e.t?e.t.toFixed(3):"N/A",this.amplitudeX=null!=e.ax?e.ax.toFixed(3):"N/A",this.amplitudeY=null!=e.ay?e.ay.toFixed(3):"N/A",this.amplitudeZ=null!=e.az?e.az.toFixed(3):"N/A",this.jacobiConstant=null!=e.cj?e.cj.toFixed(5):"N/A",this.stability=null===e.stable?"Не исследована устойчивость":e.stable?"Устойчива":"Не устойчива",e.tags){const t=Array.isArray(e.tags)?e.tags:[e.tags],a={};this.familyOptions.forEach((t=>{a[t.value]=t.label})),this.family=t.map((t=>a[t]||t)).join(", ")}else this.family="N/A";let a=await fetch(`https://orbital-catalog.auditory.ru/api/v1/trajectories/${e.id}`,{method:"GET"});if(!a.ok)throw this.noOrbitInfoFound=!0,new Error("Failed to fetch trajectory data");let i=await a.json();console.log(i),this.orb4=i||[]}catch(t){console.error(t),this.noOrbitInfoFound=!0}finally{this.isLoading=!1}}}};const st=(0,h.A)(nt,[["render",et],["__scopeId","data-v-7d1f3894"]]);var dt=st;const ct={class:"container"},ut=["onClick","innerHTML"];function pt(t,e,a,i,l,r){return(0,o.uX)(),(0,o.CE)("div",ct,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(l.systems,(t=>((0,o.uX)(),(0,o.CE)("p",{key:t.id,onClick:e=>r.selectSystem(t),class:(0,x.C4)({selected:l.selectedSystem&&l.selectedSystem.id===t.id}),innerHTML:`${t.name}<br>${t.detail}`},null,10,ut)))),128))])}var ht={data(){return{selectedSystem:null,systems:[{id:1,name:"Земля-Луна",detail:"точка L1"},{id:2,name:"Земля-Луна",detail:"точка L2"}]}},methods:{selectSystem(t){this.selectedSystem&&this.selectedSystem.id===t.id?(this.selectedSystem=null,this.$emit("update:selected-system",null)):(this.selectedSystem=t,this.$emit("update:selected-system",t.id))}}};const mt=(0,h.A)(ht,[["render",pt],["__scopeId","data-v-097e4ba4"]]);var bt=mt,ft=a.p+"img/icon.06d36db7.png";const vt={class:"container"},yt={key:0,class:"tooltip"},Lt={class:"params"};function gt(t,e,a,i,l,r){const n=(0,o.g2)("custom-select"),s=(0,o.g2)("from-to");return(0,o.uX)(),(0,o.CE)("div",vt,[(0,o.Lk)("h2",null,[e[5]||(e[5]=(0,o.eW)(" Отбор по условиям ")),(0,o.Lk)("div",{class:"info-icon-wrapper",onMouseover:e[0]||(e[0]=(...t)=>r.showTooltip&&r.showTooltip(...t)),onMouseleave:e[1]||(e[1]=(...t)=>r.hideTooltip&&r.hideTooltip(...t))},[e[4]||(e[4]=(0,o.Lk)("img",{src:ft,alt:"Информация",class:"info-icon",style:{width:"15px",height:"15px"}},null,-1)),l.tooltipVisible?((0,o.uX)(),(0,o.CE)("div",yt,e[3]||(e[3]=[(0,o.Lk)("p",null,' Введите критерии, по которым будет совершен отбор начальных условий, и нажмите кнопку "Отобрать". Если критерии не введены, будут отображены начальные условия всех орбит доступных в каталоге. ',-1),(0,o.Lk)("p",null,[(0,o.Lk)("strong",null,"Параметры системы:")],-1),(0,o.Lk)("ul",null,[(0,o.Lk)("li",null,"μ = 0,01215"),(0,o.Lk)("li",null,"Расстояние между Землей и Луной: 384400 км")],-1)]))):(0,o.Q3)("",!0)],32)]),(0,o.Lk)("div",Lt,[(0,o.Lk)("div",null,[e[6]||(e[6]=(0,o.Lk)("p",null,"Семейство",-1)),(0,o.bF)(n,{options:r.filteredFamilyLabels,modelValue:r.selectedFamilyLabel,"onUpdate:modelValue":r.onUpdateFamilyLabel},null,8,["options","modelValue","onUpdate:modelValue"])]),(0,o.Lk)("div",null,[e[7]||(e[7]=(0,o.Lk)("p",null,"Амплитуда по x (км)",-1)),(0,o.bF)(s,{filterName:"amplitudeX",initialFrom:t.filters.amplitudeX.from,initialTo:t.filters.amplitudeX.to,onUpdate:r.onUpdateFilter},null,8,["initialFrom","initialTo","onUpdate"])]),(0,o.Lk)("div",null,[e[8]||(e[8]=(0,o.Lk)("p",null,"Период (дни)",-1)),(0,o.bF)(s,{filterName:"period",initialFrom:t.filters.period.from,initialTo:t.filters.period.to,onUpdate:r.onUpdateFilter},null,8,["initialFrom","initialTo","onUpdate"])]),(0,o.Lk)("div",null,[e[9]||(e[9]=(0,o.Lk)("p",null,"Амплитуда по y (км)",-1)),(0,o.bF)(s,{filterName:"amplitudeY",initialFrom:t.filters.amplitudeY.from,initialTo:t.filters.amplitudeY.to,onUpdate:r.onUpdateFilter},null,8,["initialFrom","initialTo","onUpdate"])]),(0,o.Lk)("div",null,[e[10]||(e[10]=(0,o.Lk)("p",null,"Константа Якоби",-1)),(0,o.bF)(s,{filterName:"jacobiConstant",initialFrom:t.filters.jacobiConstant.from,initialTo:t.filters.jacobiConstant.to,onUpdate:r.onUpdateFilter},null,8,["initialFrom","initialTo","onUpdate"])]),(0,o.Lk)("div",null,[e[11]||(e[11]=(0,o.Lk)("p",null,"Амплитуда по z (км)",-1)),(0,o.bF)(s,{filterName:"amplitudeZ",initialFrom:t.filters.amplitudeZ.from,initialTo:t.filters.amplitudeZ.to,onUpdate:r.onUpdateFilter},null,8,["initialFrom","initialTo","onUpdate"])])]),(0,o.Lk)("button",{onClick:e[2]||(e[2]=(...t)=>r.applyFilters&&r.applyFilters(...t))},"Отобрать")])}const Pt=["tabindex"],kt=["src"],xt=["onClick"];function Ot(t,e,a,l,r,n){return(0,o.uX)(),(0,o.CE)("div",{class:"custom-select",tabindex:a.tabindex,onBlur:e[1]||(e[1]=(...t)=>n.closeSelect&&n.closeSelect(...t)),onKeydown:e[2]||(e[2]=(0,i.jR)(((...t)=>n.closeSelect&&n.closeSelect(...t)),["escape"]))},[(0,o.Lk)("div",{class:(0,x.C4)(["selected",{open:r.open}]),onClick:e[0]||(e[0]=(...t)=>n.toggleOpen&&n.toggleOpen(...t))},[(0,o.eW)((0,x.v_)(a.modelValue||"Выберите опцию")+" ",1),(0,o.Lk)("img",{src:r.arrowIcon,class:(0,x.C4)(["arrow",{open:r.open}]),alt:"Стрелка"},null,10,kt)],2),(0,o.bF)(i.eB,{name:"fade"},{default:(0,o.k6)((()=>[r.open?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"items",style:(0,x.Tr)({maxHeight:n.computedMaxHeight})},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.options,((t,e)=>((0,o.uX)(),(0,o.CE)("div",{key:e,onClick:e=>n.selectOption(t),class:(0,x.C4)({"selected-option":t===a.modelValue})},(0,x.v_)(t),11,xt)))),128))],4)):(0,o.Q3)("",!0)])),_:1})],40,Pt)}var Ft=a.p+"img/arrow-down.a0f24d19.svg",It={data(){return{open:!1,arrowIcon:Ft}},props:{options:{type:Array,required:!0},modelValue:{type:String,required:!1,default:""},tabindex:{type:Number,required:!1,default:0},optionHeight:{type:Number,required:!1,default:33},maxVisibleOptions:{type:Number,required:!1,default:6}},computed:{computedMaxHeight(){const t=Math.min(this.options.length,this.maxVisibleOptions);return t*this.optionHeight+"px"}},methods:{toggleOpen(){this.open=!this.open},closeSelect(){this.open=!1},selectOption(t){this.open=!1,this.$emit("update:modelValue",t)},handleClickOutside(t){const e=this.$el;e.contains(t.target)||this.closeSelect()}},mounted(){document.addEventListener("click",this.handleClickOutside)},beforeUnmount(){document.removeEventListener("click",this.handleClickOutside)}};const Ct=(0,h.A)(It,[["render",Ot],["__scopeId","data-v-2d0b7c47"]]);var Xt=Ct;const wt={class:"container-to-from"};function jt(t,e,a,l,r,n){return(0,o.uX)(),(0,o.CE)("div",wt,[e[6]||(e[6]=(0,o.Lk)("p",null,"от",-1)),(0,o.bo)((0,o.Lk)("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=t=>n.formattedFrom=t),onInput:e[1]||(e[1]=(...t)=>n.onFromInput&&n.onFromInput(...t)),onBlur:e[2]||(e[2]=(...t)=>n.formatFrom&&n.formatFrom(...t)),placeholder:"0"},null,544),[[i.Jo,n.formattedFrom]]),e[7]||(e[7]=(0,o.Lk)("p",null,"до",-1)),(0,o.bo)((0,o.Lk)("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=t=>n.formattedTo=t),onInput:e[4]||(e[4]=(...t)=>n.onToInput&&n.onToInput(...t)),onBlur:e[5]||(e[5]=(...t)=>n.formatTo&&n.formatTo(...t)),placeholder:"0"},null,544),[[i.Jo,n.formattedTo]])])}var $t={props:{filterName:{type:String,required:!0},initialFrom:{type:[Number,String,null],default:""},initialTo:{type:[Number,String,null],default:""}},data(){return{from:null!=this.initialFrom?this.initialFrom.toString():"",to:null!=this.initialTo?this.initialTo.toString():""}},computed:{formattedFrom:{get(){return this.from.replace(".",",")},set(t){this.from=t}},formattedTo:{get(){return this.to.replace(".",",")},set(t){this.to=t}}},methods:{...(0,E.i0)(["updateFilter"]),normalizeInput(t){return t.replace(",",".").trim()},isValidNumber(t){const e=this.normalizeInput(t);return!isNaN(parseFloat(e))&&isFinite(e)},onFromInput(t){const e=t.target.value;this.from=e,this.emitUpdate()},onToInput(t){const e=t.target.value;this.to=e,this.emitUpdate()},formatFrom(){if(this.isValidNumber(this.from)){const t=parseFloat(this.normalizeInput(this.from));this.from=t.toString().replace(".",",")}else this.from="";this.emitUpdate()},formatTo(){if(this.isValidNumber(this.to)){const t=parseFloat(this.normalizeInput(this.to));this.to=t.toString().replace(".",",")}else this.to="";this.emitUpdate()},emitUpdate(){const t=this.isValidNumber(this.from)?parseFloat(this.normalizeInput(this.from)):null,e=this.isValidNumber(this.to)?parseFloat(this.normalizeInput(this.to)):null;this.updateFilter({filterName:this.filterName,value:{from:t,to:e}})}},watch:{initialFrom(t){this.from=null!=t?t.toString():""},initialTo(t){this.to=null!=t?t.toString():""}}};const zt=(0,h.A)($t,[["render",jt],["__scopeId","data-v-45983235"]]);var Dt=zt,Nt={components:{fromTo:Dt,CustomSelect:Xt},props:{selectedSystemId:{type:Number,default:null}},data(){return{familyOptions:[{label:"Все",value:""},{label:"Горизонтальные орбиты Ляпунова, L1",value:"L1.L"},{label:"Горизонтальные орбиты Ляпунова, L2",value:"L2.L"},{label:"Вертикальные орбиты Ляпунова, L1",value:"L1.V"},{label:"Вертикальные орбиты Ляпунова, L2",value:"L2.V"},{label:"Гало орбиты, L1",value:"L1.H"},{label:"Гало орбиты, L2",value:"L2.H"},{label:"Двухпериодические квазигоризонтальные орбиты, L1",value:"L1.L.2P1"},{label:"Двухпериодические квазигоризонтальные орбиты, L2",value:"L2.L.2P1"},{label:"Трехпериодические квазигоризонтальные орбиты, L1",value:"L1.L.3P1"},{label:"Трехпериодические квазигоризонтальные орбиты, L2",value:"L2.L.3P1"},{label:"Четырехпериодические квазигоризонтальные орбиты, L1",value:"L1.L.4P1"},{label:"Четырехпериодические квазигоризонтальные орбиты, L2",value:"L2.L.4P1"},{label:"Четырехпериодические квазигоризонтальные орбиты, L1 (2P1.2P1)",value:"L1.L.2P1.2P1"},{label:"Четырехпериодические квазигоризонтальные орбиты, L2 (2P1.2P1)",value:"L2.L.2P1.2P1"},{label:"Шестипериодические квазигоризонтальные орбиты, L1 (2P1.3P1)",value:"L1.L.2P1.3P1"},{label:"Шестипериодические квазигоризонтальные орбиты, L1 (2P1.3P2)",value:"L1.L.2P1.3P2"},{label:"Шестипериодические квазигоризонтальные орбиты, L2 (2P1.3P1)",value:"L2.L.2P1.3P1"},{label:"Шестипериодические квазигоризонтальные орбиты, L2 (2P1.3P2)",value:"L2.L.2P1.3P2"},{label:"Двухпериодические квазигало орбиты, L1 (2P1)",value:"L1.H.2P1"},{label:"Двухпериодические квазигало орбиты, L1 (2P2)",value:"L1.H.2P2"},{label:"Двухпериодические квазигало орбиты, L1 (2P3)",value:"L1.H.2P3"},{label:"Двухпериодические квазигало орбиты, L2 (2P1)",value:"L2.H.2P1"},{label:"Двухпериодические квазигало орбиты, L2 (2P2)",value:"L2.H.2P2"},{label:"Трехпериодические квазигало орбиты, L1 (3P1)",value:"L1.H.3P1"},{label:"Трехпериодические квазигало орбиты, L1 (3P2)",value:"L1.H.3P2"},{label:"Трехпериодические квазигало орбиты, L1 (3P3)",value:"L1.H.3P3"},{label:"Трехпериодические квазигало орбиты, L2 (3P1)",value:"L2.H.3P1"},{label:"Четырехпериодические квазигало орбиты, L1",value:"L1.H.4P1"},{label:"Квазипериодические орбиты, L1",value:"L1.Q"}],tooltipVisible:!1}},computed:{...(0,E.aH)(["filters"]),filteredFamilyOptions(){return 1===this.selectedSystemId?this.familyOptions.filter((t=>t.value.includes("L1"))):2===this.selectedSystemId?this.familyOptions.filter((t=>t.value.includes("L2"))):this.familyOptions},filteredFamilyLabels(){return this.filteredFamilyOptions.map((t=>t.label))},selectedFamilyLabel:{get(){const t=this.filteredFamilyOptions.find((t=>t.value===this.filters.family));return t?t.label:"Все"},set(t){const e=this.filteredFamilyOptions.find((e=>e.label===t));e?this.updateFamily(e.value):this.updateFamily("")}}},watch:{selectedSystemId(t,e){t!==e&&this.updateFamily("")}},methods:{...(0,E.PY)(["selectOrbit"]),...(0,E.i0)(["updateFilter","updateFamily","setSynchronizedFilters"]),onUpdateFilter({filterName:t,value:e}){this.updateFilter({filterName:t,value:e})},onUpdateFamilyLabel(t){const e=this.filteredFamilyOptions.find((e=>e.label===t));e?this.updateFamily(e.value):this.updateFamily("")},applyFilters(){this.selectOrbit(),this.$emit("filter-applied")},showTooltip(){this.tooltipVisible=!0},hideTooltip(){this.tooltipVisible=!1}}};const Et=(0,h.A)(Nt,[["render",gt],["__scopeId","data-v-5ae49b0a"]]);var St=Et,Yt={components:{MapImg:T,OrbitInformation:dt,systemSelection:bt,SelectionByConditions:St},data(){return{selectedSystemId:null}},methods:{updateSelectedSystemId(t){this.selectedSystemId=t,this.updateMapData()},updateMapData(){this.$refs.MapImg&&this.$refs.MapImg.fetchOrbits()},updateOrbitInfo(){this.$refs.OrbitInformation&&this.$refs.OrbitInformation.submit()}},computed:{...(0,E.aH)(["selectedOrbit","informationOrbit"])},watch:{selectedOrbit(t){1===t&&this.$nextTick((()=>{this.updateMapData()}))}}};const Tt=(0,h.A)(Yt,[["render",k],["__scopeId","data-v-59dd5f68"]]);var Vt=Tt;const _t={class:"container-main"},At={key:0,class:"error-message"};function Ut(t,e,a,i,l,r){const n=(0,o.g2)("displayTypeBlock"),s=(0,o.g2)("OrbitInformationBuild"),d=(0,o.g2)("OrbitProjections"),c=(0,o.g2)("NearestOrbitPoincare"),u=(0,o.g2)("PoincareSectionWithCj"),p=(0,o.g2)("ParameterChangeGraph");return(0,o.uX)(),(0,o.CE)("div",_t,[(0,o.bF)(n,{orbitCoordinates:l.orbitCoordinates,selectedOption:l.selectedOption,"onUpdate:selectedOption":e[0]||(e[0]=t=>l.selectedOption=t),jacobiConstant:l.jacobiConstant,onUpdateOrbitCoordinates:r.updateOrbitCoordinates,onFindNearestOrbit:r.findNearestOrbit,onUpdatePoincarePlane:r.updatePoincarePlane,onBuildPoincareSectionWithCj:r.buildPoincareSectionWithCj,onBuildParameterChangeGraph:r.buildParameterChangeGraph},null,8,["orbitCoordinates","selectedOption","jacobiConstant","onUpdateOrbitCoordinates","onFindNearestOrbit","onUpdatePoincarePlane","onBuildPoincareSectionWithCj","onBuildParameterChangeGraph"]),l.orbitNotFound?((0,o.uX)(),(0,o.CE)("div",At,[e[2]||(e[2]=(0,o.Lk)("p",null,"Орбита не найдена. Попробуйте изменить параметры поиска.",-1)),(0,o.Lk)("button",{onClick:e[1]||(e[1]=(...t)=>r.findNearestOrbit&&r.findNearestOrbit(...t))},"Поиск снова")])):"Орбита в 3D"===l.selectedOption&&t.orbitId?((0,o.uX)(),(0,o.Wv)(s,{key:1,parentLoading:l.isLoading,onUpdateOrbitCoordinates:r.updateOrbitCoordinates,onUpdateFamily:r.updateFamily,onUpdateJacobiConstant:r.updateJacobiConstant},null,8,["parentLoading","onUpdateOrbitCoordinates","onUpdateFamily","onUpdateJacobiConstant"])):"Проекции орбиты"===l.selectedOption&&t.orbitId?((0,o.uX)(),(0,o.Wv)(d,{key:2,orbitId:t.orbitId,globalLoading:l.isLoading,onUpdateOrbitCoordinates:r.updateOrbitCoordinates},null,8,["orbitId","globalLoading","onUpdateOrbitCoordinates"])):"Сечение Пуанкаре одной орбиты"===l.selectedOption&&t.orbitId?((0,o.uX)(),(0,o.Wv)(c,{parentLoading:l.isLoading,poincarePlane:l.poincarePlane,onUpdateOrbitCoordinates:r.updateOrbitCoordinates,onUpdateFamily:r.updateFamily,onUpdateJacobiConstant:r.updateJacobiConstant,key:t.orbitId},null,8,["parentLoading","poincarePlane","onUpdateOrbitCoordinates","onUpdateFamily","onUpdateJacobiConstant"])):"Сечение Пуанкаре с заданным значением константы Якоби"===l.selectedOption?((0,o.uX)(),(0,o.Wv)(u,{key:4,librationPoint:l.librationPoint,cj:l.jacobiConstant,d:l.jacobiError,plane:l.poincarePlane},null,8,["librationPoint","cj","d","plane"])):(0,o.Q3)("",!0),"График изменения параметра в семействе"===l.selectedOption&&l.family&&l.paramX&&l.paramY?((0,o.uX)(),(0,o.Wv)(p,{key:5,family:l.family,paramX:l.paramX,paramY:l.paramY},null,8,["family","paramX","paramY"])):(0,o.Q3)("",!0)])}const Mt={class:"container"},Ht={key:0,class:"loading-message"},Zt={key:1,class:"content"},Bt={class:"info"},qt={key:0,class:"min-container"},Gt={key:0},Jt={key:1},Rt={key:1,class:"no-orbits-message"},Qt={class:"info-2"},Wt={key:0,class:"csv"},Kt={key:1,class:"no-orbits-message"};function te(t,e,a,i,l,r){const n=(0,o.g2)("PlotlyCsv3d");return(0,o.uX)(),(0,o.CE)("div",Mt,[r.combinedIsLoading?((0,o.uX)(),(0,o.CE)("div",Ht,e[0]||(e[0]=[(0,o.Lk)("div",{class:"spinner"},null,-1),(0,o.Lk)("p",null,"Загрузка данных орбиты...",-1)]))):((0,o.uX)(),(0,o.CE)("div",Zt,[(0,o.Lk)("div",Bt,[e[2]||(e[2]=(0,o.Lk)("h3",null,"Информация об орбите",-1)),l.noOrbitInfoFound?((0,o.uX)(),(0,o.CE)("div",Rt,e[1]||(e[1]=[(0,o.Lk)("p",null,"К сожалению, информация об орбите не найдена.",-1)]))):((0,o.uX)(),(0,o.CE)("div",qt,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(l.orbitInfo,((t,e)=>((0,o.uX)(),(0,o.CE)("div",{class:"point",key:e},[(0,o.Lk)("p",null,(0,x.v_)(l.labels[e]),1),"period"===e?((0,o.uX)(),(0,o.CE)("p",Gt,(0,x.v_)(r.displayPeriod),1)):((0,o.uX)(),(0,o.CE)("p",Jt,(0,x.v_)(t),1))])))),128))]))]),(0,o.Lk)("div",Qt,[e[4]||(e[4]=(0,o.Lk)("h3",null,"Визуализация орбиты",-1)),(0,o.Lk)("div",null,[l.noOrbitInfoFound?((0,o.uX)(),(0,o.CE)("div",Kt,e[3]||(e[3]=[(0,o.Lk)("p",null,"К сожалению, данные графика орбиты не найдены.",-1)]))):((0,o.uX)(),(0,o.CE)("div",Wt,[(0,o.bF)(n,{csvData:l.orb4,class:"csv-orb"},null,8,["csvData"])]))])])]))])}var ee={components:{PlotlyCsv3d:rt},props:{selectedOption:String,parentLoading:{type:Boolean,default:!1}},emits:["update-orbit-coordinates","update-family","update-jacobi-constant"],data(){return{orbitInfo:{period:null,amplitudeX:null,amplitudeY:null,amplitudeZ:null,jacobiConstant:null,stability:null,family:null},orb4:[],noOrbitInfoFound:!1,localLoading:!1,labels:{period:"Период (дни)",amplitudeX:"Амплитуда по x (км)",amplitudeY:"Амплитуда по y (км)",amplitudeZ:"Амплитуда по z (км)",jacobiConstant:"Значение константы Якоби",stability:"Устойчивость",family:"Семейство"},familyOptions:[{label:"Горизонтальные орбиты Ляпунова, L1",value:"L1.L"},{label:"Горизонтальные орбиты Ляпунова, L2",value:"L2.L"},{label:"Вертикальные орбиты Ляпунова, L1",value:"L1.V"},{label:"Вертикальные орбиты Ляпунова, L2",value:"L2.V"},{label:"Аксиальные орбиты, L1",value:"L1.A"},{label:"Аксиальные орбиты, L2",value:"L2.A"},{label:"Гало орбиты, L1",value:"L1.H"},{label:"Гало орбиты, L2",value:"L2.H"},{label:"Двухпериодические квазигоризонтальные орбиты, L1",value:"L1.L.2P1"},{label:"Двухпериодические квазигоризонтальные орбиты, L2",value:"L2.L.2P1"},{label:"Трехпериодические квазигоризонтальные орбиты, L1",value:"L1.L.3P1"},{label:"Трехпериодические квазигоризонтальные орбиты, L2",value:"L2.L.3P1"},{label:"Четырехпериодические квазигоризонтальные орбиты, L1",value:"L1.L.4P1"},{label:"Четырехпериодические квазигоризонтальные орбиты, L2",value:"L2.L.4P1"},{label:"Четырехпериодические квазигоризонтальные орбиты, L1 (2P1.2P1)",value:"L1.L.2P1.2P1"},{label:"Четырехпериодические квазигоризонтальные орбиты, L2 (2P1.2P1)",value:"L2.L.2P1.2P1"},{label:"Шестипериодические квазигоризонтальные орбиты, L1 (2P1.3P1)",value:"L1.L.2P1.3P1"},{label:"Шестипериодические квазигоризонтальные орбиты, L1 (2P1.3P2)",value:"L1.L.2P1.3P2"},{label:"Шестипериодические квазигоризонтальные орбиты, L2 (2P1.3P1)",value:"L2.L.2P1.3P1"},{label:"Шестипериодические квазигоризонтальные орбиты, L2 (2P1.3P2)",value:"L2.L.2P1.3P2"},{label:"Двухпериодические квазигоризонтальные орбиты, L1 (2P1.Tan)",value:"L1.L.2P1.Tan"},{label:"Двухпериодические квазигоризонтальные орбиты, L2 (2P1.Tan)",value:"L2.L.2P1.Tan"},{label:"Двухпериодические квазигало орбиты, L1 (2P1)",value:"L1.H.2P1"},{label:"Двухпериодические квазигало орбиты, L1 (2P2)",value:"L1.H.2P2"},{label:"Двухпериодические квазигало орбиты, L1 (2P3)",value:"L1.H.2P3"},{label:"Двухпериодические квазигало орбиты, L2 (2P1)",value:"L2.H.2P1"},{label:"Двухпериодические квазигало орбиты, L2 (2P2)",value:"L2.H.2P2"},{label:"Трехпериодические квазигало орбиты, L1 (3P1)",value:"L1.H.3P1"},{label:"Трехпериодические квазигало орбиты, L1 (3P2)",value:"L1.H.3P2"},{label:"Трехпериодические квазигало орбиты, L1 (3P3)",value:"L1.H.3P3"},{label:"Трехпериодические квазигало орбиты, L2 (3P1)",value:"L2.H.3P1"},{label:"Квазипериодические орбиты, L1",value:"L1.Q"},{label:"Четырехпериодические квазигало орбиты, L1",value:"L1.H.4P1"}]}},computed:{...(0,E.L8)(["orbitId","getOrbitData"]),combinedIsLoading(){return this.parentLoading||this.localLoading},displayPeriod(){return-1===Number(this.orbitInfo.period)?"Орбита квазипериодическая":null!==this.orbitInfo.period?Number(this.orbitInfo.period).toFixed(2):"N/A"}},watch:{orbitId(t){t?this.loadOrbitData(t):(this.noOrbitInfoFound=!0,this.resetData())}},mounted(){this.orbitId?this.loadOrbitData(this.orbitId):this.noOrbitInfoFound=!0},methods:{...(0,E.i0)(["cacheOrbitData"]),resetData(){this.orbitInfo={period:null,amplitudeX:null,amplitudeY:null,amplitudeZ:null,jacobiConstant:null,stability:null,family:null},this.orb4=[]},mapFamilyTags(t){if(!t)return"N/A";const e=Array.isArray(t)?t:[t],a={};this.familyOptions.forEach((t=>{a[t.value]=t.label}));const i=e.map((t=>a[t]||t));return i.join(", ")},async loadOrbitData(t){const e=this.getOrbitData(t);if(e&&e.orbitInfo&&e.trajectory)return console.log(`OrbitInformationBuild.vue: Используем кешированные данные для orbitId: ${t}`),void this.setOrbitData(e);this.localLoading=!0;try{let a=await fetch(`https://orbital-catalog.auditory.ru/api/v1/orbits/${t}`,{method:"GET"});if(!a.ok)throw this.noOrbitInfoFound=!0,new Error("Failed to fetch orbit data");let i=await a.json();if(!i||void 0===i.t)return void(this.noOrbitInfoFound=!0);this.noOrbitInfoFound=!1,this.orbitInfo.period=null!==i.t?i.t:null,this.orbitInfo.amplitudeX=null!==i.ax?i.ax:null,this.orbitInfo.amplitudeY=null!==i.ay?i.ay:null,this.orbitInfo.amplitudeZ=null!==i.az?i.az:null,this.orbitInfo.jacobiConstant=null!==i.cj?i.cj:null,this.orbitInfo.stability=null===i.stable?"Не исследована устойчивость":i.stable?"Устойчива":"Не устойчива",this.orbitInfo.family=this.mapFamilyTags(i.tags);let o=e?e.trajectory:[];if(0===o.length){let t=await fetch(`https://orbital-catalog.auditory.ru/api/v1/trajectories/${i.id}`,{method:"GET"});if(t.ok){let e=await t.json();if(o=e||[],o.length>0){const t=o[0];this.$emit("update-orbit-coordinates",{x:t.x,y:t.y,z:t.z,vx:t.vx,vy:t.vy,vz:t.vz})}else console.error("Trajectory data is empty.")}else console.error("Failed to fetch trajectory data")}else if(o.length>0){const t=o[0];this.$emit("update-orbit-coordinates",{x:t.x,y:t.y,z:t.z,vx:t.vx,vy:t.vy,vz:t.vz})}this.orb4=o,this.$emit("update-family",this.orbitInfo.family),this.$emit("update-jacobi-constant",this.orbitInfo.jacobiConstant),this.cacheOrbitData({id:t,orbitInfo:this.orbitInfo,trajectory:this.orb4})}catch(a){console.error("OrbitInformationBuild.vue: Ошибка при получении данных орбиты:",a),this.noOrbitInfoFound=!0,this.resetData()}finally{this.localLoading=!1}},setOrbitData(t){if(t.orbitInfo&&t.trajectory){if(this.orbitInfo={...t.orbitInfo},this.orb4=[...t.trajectory],this.noOrbitInfoFound=!1,this.orb4.length>0){const t=this.orb4[0];this.$emit("update-orbit-coordinates",{x:t.x,y:t.y,z:t.z,vx:t.vx,vy:t.vy,vz:t.vz})}this.cacheOrbitData({id:this.orbitId,orbitInfo:this.orbitInfo,trajectory:this.orb4})}else this.noOrbitInfoFound=!0,this.resetData()}}};const ae=(0,h.A)(ee,[["render",te],["__scopeId","data-v-dcb0c172"]]);var ie=ae;const oe={class:"container"},le={key:0,class:"loading-message"},re={key:1,class:"projections"},ne={key:2,class:"no-data-message"};function se(t,e,a,i,l,r){const n=(0,o.g2)("Plotly2DProjection");return(0,o.uX)(),(0,o.CE)("div",oe,[e[2]||(e[2]=(0,o.Lk)("h3",null,"Проекции орбиты",-1)),a.globalLoading?((0,o.uX)(),(0,o.CE)("div",le,e[0]||(e[0]=[(0,o.Lk)("div",{class:"spinner"},null,-1),(0,o.Lk)("p",null,"Загрузка данных проекций...",-1)]))):l.data&&l.data.length?((0,o.uX)(),(0,o.CE)("div",re,[(0,o.bF)(n,{csvData:l.data,projection:"xy"},null,8,["csvData"]),(0,o.bF)(n,{csvData:l.data,projection:"xz"},null,8,["csvData"]),(0,o.bF)(n,{csvData:l.data,projection:"yz"},null,8,["csvData"])])):((0,o.uX)(),(0,o.CE)("div",ne,e[1]||(e[1]=[(0,o.Lk)("p",null,"К сожалению, данные проекций не найдены.",-1)])))])}const de=["id"];function ce(t,e,a,i,l,r){return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.Lk)("div",null,[(0,o.Lk)("div",{id:l.chartId,class:"plotly-chart"},null,8,de)])])}var ue={props:{csvData:{type:Array,required:!0,default:()=>[]},projection:{type:String,required:!0,validator:t=>["xy","xz","yz"].includes(t)}},data(){return{chartId:`plotly-chart-${Math.random().toString(36).substr(2,9)}`,isPlotting:!1}},computed:{combinedIsLoading(){return this.isPlotting||this.globalLoading}},mounted(){this.plotData()},watch:{csvData(){this.plotData()},projection(){this.plotData()},globalLoading(t){!t&&this.csvData.length>0&&this.plotData()}},methods:{plotData(){if(!this.csvData||0===this.csvData.length)return void console.error("No data provided for 2D projection.");let t,e,a,i;this.isPlotting=!0,"xy"===this.projection?(t=this.csvData.map((t=>parseFloat(t.x)/1e3)),e=this.csvData.map((t=>parseFloat(t.y)/1e3)),a="X, 10³ км",i="Y, 10³ км"):"xz"===this.projection?(t=this.csvData.map((t=>parseFloat(t.x)/1e3)),e=this.csvData.map((t=>parseFloat(t.z)/1e3)),a="X, 10³ км",i="Z, 10³ км"):"yz"===this.projection&&(t=this.csvData.map((t=>parseFloat(t.y)/1e3)),e=this.csvData.map((t=>parseFloat(t.z)/1e3)),a="Y, 10³ км",i="Z, 10³ км");const o=this.csvData.map((t=>Math.sqrt(Math.pow(parseFloat(t.vx),2)+Math.pow(parseFloat(t.vy),2)+Math.pow(parseFloat(t.vz),2)))),l=this.csvData.map(((a,i)=>{const l=o[i].toFixed(3);let r=[];return"xy"===this.projection?(r.push(`X: ${t[i].toFixed(3)} 10³ км`),r.push(`Y: ${e[i].toFixed(3)} 10³ км`)):"xz"===this.projection?(r.push(`X: ${t[i].toFixed(3)} 10³ км`),r.push(`Z: ${e[i].toFixed(3)} 10³ км`)):"yz"===this.projection&&(r.push(`Y: ${t[i].toFixed(3)} 10³ км`),r.push(`Z: ${e[i].toFixed(3)} 10³ км`)),r.push(`V: ${l} км/с`),r.join("<br>")})),r={x:t,y:e,mode:"lines",type:"scatter",name:"Траектория",line:{color:"blue",width:2},text:l,hoverinfo:"text"},n=Math.min(...t),s=Math.max(...t),d=Math.min(...e),c=Math.max(...e),u=s-n,p=c-d,h=t=>Math.floor(t/6),m=t=>{const e=2;return t>=e?".0f":".8~f"},b=.1*u,f=.1*p,v={xaxis:{title:{text:a,standoff:20},zeroline:!1,tickformat:m(u),dtick:h(u),range:[n-b,s+b],automargin:!0,tickfont:{size:12},tickangle:-45,constrain:"domain"},yaxis:{title:{text:i,standoff:20},zeroline:!1,tickformat:m(p),dtick:h(p),range:[d-f,c+f],automargin:!0,tickfont:{size:12},tickangle:0,constrain:"domain"},margin:{l:70,r:70,b:70,t:70},hovermode:"closest"},y={displayModeBar:!1,responsive:!0};N().newPlot(this.chartId,[r],v,y).then((()=>{})).catch((t=>{console.error("Ошибка при построении графика Plotly:",t)})).finally((()=>{this.isPlotting=!1}))}}};const pe=(0,h.A)(ue,[["render",ce],["__scopeId","data-v-04ec1bca"]]);var he=pe,me={components:{Plotly2DProjection:he},props:{orbitId:{type:[String,Number],required:!0},globalLoading:{type:Boolean,default:!1}},emits:["update-orbit-coordinates"],data(){return{data:[],isLoading:!1}},computed:{...(0,E.L8)(["getTrajectory"]),combinedIsLoading(){return this.isLoading}},watch:{orbitId(t){console.log(`OrbitProjections.vue: orbitId изменился на ${t}`),t?this.fetchTrajectoryData(t):this.data=[]}},created(){this.orbitId?(console.log(`OrbitProjections.vue: Создаёмся с orbitId: ${this.orbitId}`),this.fetchTrajectoryData(this.orbitId)):console.error("OrbitProjections.vue: orbitId не найден в URL.")},methods:{...(0,E.i0)(["cacheTrajectoryData"]),async fetchTrajectoryData(t){console.log(`OrbitProjections.vue: Начинаем загрузку траектории для orbitId: ${t}`),this.isLoading=!0;try{const e=this.getTrajectory(t);if(e&&e.length>0)return console.log(`OrbitProjections.vue: Используем кешированные данные траектории для orbitId: ${t}`),this.data=e,void this.emitFirstPoint(e);const a=await fetch(`https://orbital-catalog.auditory.ru/api/v1/trajectories/${t}`,{method:"GET"});if(!a.ok)throw new Error("Не удалось получить данные траектории.");const i=await a.json();console.log("OrbitProjections.vue: Полученные данные траектории:",i),this.data=i||[],this.data.length>0?(this.emitFirstPoint(this.data),this.cacheTrajectoryData({id:t,trajectory:this.data}),console.log(`OrbitProjections.vue: Кешируем траекторию для orbitId: ${t}`)):console.warn("OrbitProjections.vue: Данные траектории пусты.")}catch(e){console.error("OrbitProjections.vue: Ошибка при получении данных траектории:",e),this.data=[]}finally{this.isLoading=!1,console.log(`OrbitProjections.vue: Завершили загрузку траектории для orbitId: ${t}`)}},emitFirstPoint(t){const e=t[0];e&&void 0!==e.x?(console.log("OrbitProjections.vue: Эмитируем координаты первой точки траектории:",e),this.$emit("update-orbit-coordinates",{x:e.x,y:e.y,z:e.z,vx:e.vx,vy:e.vy,vz:e.vz})):console.warn("OrbitProjections.vue: Первый пункт траектории не содержит необходимых данных.")}}};const be=(0,h.A)(me,[["render",se],["__scopeId","data-v-4b6794a2"]]);var fe=be;const ve={class:"container"},ye={key:0,class:"component"},Le={class:"coordinates"},ge={key:1,class:"component"},Pe={class:"coordinates"},ke={key:2,class:"component"},xe={key:3,class:"component"},Oe={class:"coordinates"},Fe={key:4,class:"component"},Ie={key:0,class:"error-message"};function Ce(t,e,a,l,r,n){const s=(0,o.g2)("customSelect");return(0,o.uX)(),(0,o.CE)("div",ve,[e[51]||(e[51]=(0,o.Lk)("h3",null,"Выберите тип графика",-1)),(0,o.bF)(s,{modelValue:r.localSelectedOption,"onUpdate:modelValue":e[0]||(e[0]=t=>r.localSelectedOption=t),options:r.options},null,8,["modelValue","options"]),"Орбита в 3D"===r.localSelectedOption?((0,o.uX)(),(0,o.CE)("div",ye,[e[31]||(e[31]=(0,o.Lk)("h3",null,"Орбита в 3D",-1)),e[32]||(e[32]=(0,o.Lk)("label",{for:"plane"},"Начальные координаты орбиты",-1)),(0,o.Lk)("div",Le,[e[29]||(e[29]=(0,o.Lk)("label",{for:"x"},"X (км)",-1)),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>r.localInputs.x=t),id:"x",type:"number",step:"any",onInput:e[2]||(e[2]=t=>n.validateInput(t,"x")),onBlur:e[3]||(e[3]=t=>n.emitCoordinate("x"))},null,544),[[i.Jo,r.localInputs.x]]),e[30]||(e[30]=(0,o.Lk)("label",{for:"z"},"Z (км)",-1)),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>r.localInputs.z=t),id:"z",type:"number",step:"any",onInput:e[5]||(e[5]=t=>n.validateInput(t,"z")),onBlur:e[6]||(e[6]=t=>n.emitCoordinate("z"))},null,544),[[i.Jo,r.localInputs.z]])])])):(0,o.Q3)("",!0),"Проекции орбиты"===r.localSelectedOption?((0,o.uX)(),(0,o.CE)("div",ge,[e[35]||(e[35]=(0,o.Lk)("h3",null,"Проекции орбиты",-1)),e[36]||(e[36]=(0,o.Lk)("label",{for:"plane"},"Начальные координаты орбиты",-1)),(0,o.Lk)("div",Pe,[e[33]||(e[33]=(0,o.Lk)("label",{for:"x"},"X (км)",-1)),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":e[7]||(e[7]=t=>r.localInputs.x=t),id:"x",type:"number",step:"any",onInput:e[8]||(e[8]=t=>n.validateInput(t,"x")),onBlur:e[9]||(e[9]=t=>n.emitCoordinate("x"))},null,544),[[i.Jo,r.localInputs.x]]),e[34]||(e[34]=(0,o.Lk)("label",{for:"z"},"Z (км)",-1)),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":e[10]||(e[10]=t=>r.localInputs.z=t),id:"z",type:"number",step:"any",onInput:e[11]||(e[11]=t=>n.validateInput(t,"z")),onBlur:e[12]||(e[12]=t=>n.emitCoordinate("z"))},null,544),[[i.Jo,r.localInputs.z]])])])):(0,o.Q3)("",!0),"График изменения параметра в семействе"===r.localSelectedOption?((0,o.uX)(),(0,o.CE)("div",ke,[e[37]||(e[37]=(0,o.Lk)("h3",null,"График изменения параметра в семействе",-1)),e[38]||(e[38]=(0,o.Lk)("label",{for:"family"},"Выберите семейство",-1)),(0,o.bF)(s,{modelValue:r.selectedFamilyLabel,"onUpdate:modelValue":e[13]||(e[13]=t=>r.selectedFamilyLabel=t),options:n.familyLabels},null,8,["modelValue","options"]),e[39]||(e[39]=(0,o.Lk)("label",{for:"paramX"},"Параметр по оси X",-1)),(0,o.bF)(s,{modelValue:r.paramX,"onUpdate:modelValue":e[14]||(e[14]=t=>r.paramX=t),options:n.filteredParamOptions},null,8,["modelValue","options"]),e[40]||(e[40]=(0,o.Lk)("label",{for:"paramY"},"Параметр по оси Y",-1)),(0,o.bF)(s,{modelValue:r.paramY,"onUpdate:modelValue":e[15]||(e[15]=t=>r.paramY=t),options:n.filteredParamOptions},null,8,["modelValue","options"])])):(0,o.Q3)("",!0),"Сечение Пуанкаре одной орбиты"===r.localSelectedOption?((0,o.uX)(),(0,o.CE)("div",xe,[e[43]||(e[43]=(0,o.Lk)("h3",null,"Сечение Пуанкаре одной орбиты",-1)),e[44]||(e[44]=(0,o.Lk)("label",{for:"plane"},"Начальные координаты орбиты",-1)),(0,o.Lk)("div",Oe,[e[41]||(e[41]=(0,o.Lk)("label",{for:"x"},"X (км)",-1)),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":e[16]||(e[16]=t=>r.localInputs.x=t),id:"x",type:"number",step:"any",onInput:e[17]||(e[17]=t=>n.validateInput(t,"x")),onBlur:e[18]||(e[18]=t=>n.emitCoordinate("x"))},null,544),[[i.Jo,r.localInputs.x]]),e[42]||(e[42]=(0,o.Lk)("label",{for:"z"},"Z (км)",-1)),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":e[19]||(e[19]=t=>r.localInputs.z=t),id:"z",type:"number",step:"any",onInput:e[20]||(e[20]=t=>n.validateInput(t,"z")),onBlur:e[21]||(e[21]=t=>n.emitCoordinate("z"))},null,544),[[i.Jo,r.localInputs.z]])]),e[45]||(e[45]=(0,o.Lk)("label",{for:"plane"},"Выберите плоскость",-1)),(0,o.bF)(s,{modelValue:r.poincarePlane,"onUpdate:modelValue":e[22]||(e[22]=t=>r.poincarePlane=t),options:r.planeOptions},null,8,["modelValue","options"])])):(0,o.Q3)("",!0),"Сечение Пуанкаре с заданным значением константы Якоби"===r.localSelectedOption?((0,o.uX)(),(0,o.CE)("div",Fe,[e[46]||(e[46]=(0,o.Lk)("h3",null,"Сечение Пуанкаре с заданным значением константы Якоби",-1)),e[47]||(e[47]=(0,o.Lk)("label",{for:"librationPoint"},"Выберите точку либрации",-1)),(0,o.bF)(s,{modelValue:r.librationPoint,"onUpdate:modelValue":e[23]||(e[23]=t=>r.librationPoint=t),options:r.librationPointOptions},null,8,["modelValue","options"]),e[48]||(e[48]=(0,o.Lk)("label",{for:"plane"},"Выберите плоскость",-1)),(0,o.bF)(s,{modelValue:r.poincarePlane,"onUpdate:modelValue":e[24]||(e[24]=t=>r.poincarePlane=t),options:r.planeOptions},null,8,["modelValue","options"]),e[49]||(e[49]=(0,o.Lk)("label",{for:"jacobiConstant"},"Константа Якоби",-1)),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":e[25]||(e[25]=t=>r.jacobiConstantLocal=t),type:"number",step:"0.1"},null,512),[[i.Jo,r.jacobiConstantLocal,void 0,{number:!0}]]),e[50]||(e[50]=(0,o.Lk)("label",{for:"error"},"Погрешность",-1)),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":e[26]||(e[26]=t=>r.jacobiError=t),type:"number",step:"0.00001",max:"0.01",onInput:e[27]||(e[27]=(...t)=>n.validateError&&n.validateError(...t))},null,544),[[i.Jo,r.jacobiError,void 0,{number:!0}]]),r.errorValidationMessage?((0,o.uX)(),(0,o.CE)("p",Ie,(0,x.v_)(r.errorValidationMessage),1)):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0),(0,o.Lk)("button",{onClick:e[28]||(e[28]=(...t)=>n.buildGraph&&n.buildGraph(...t))},"Построить")])}var Xe={components:{customSelect:Xt},props:{orbitCoordinates:{type:Object,required:!0},selectedOption:{type:String,required:!0},jacobiConstant:{type:Number,default:null}},emits:["update:selectedOption","update-orbit-coordinates","find-nearest-orbit","update-poincare-plane","build-poincare-section-with-cj","build-parameter-change-graph"],data(){return{localSelectedOption:this.selectedOption,localInputs:{x:this.formatNumber(this.orbitCoordinates.x),y:this.formatNumber(this.orbitCoordinates.y),z:this.formatNumber(this.orbitCoordinates.z),vx:this.formatNumber(this.orbitCoordinates.vx),vy:this.formatNumber(this.orbitCoordinates.vy),vz:this.formatNumber(this.orbitCoordinates.vz)},paramX:null,paramY:null,poincarePlane:this.$store.state.poincarePlane||null,jacobiConstantLocal:this.jacobiConstant??1,jacobiError:.001,options:["Орбита в 3D","Проекции орбиты","График изменения параметра в семействе","Сечение Пуанкаре одной орбиты","Сечение Пуанкаре с заданным значением константы Якоби"],paramOptions:["Период","Амплитуда по X","Амплитуда по Y","Амплитуда по Z","Расстояние до Земли","Расстояние до Луны","Константа Якоби","Максимальный множитель Флоке"],planeOptions:["x = 0","y = 0","z = 0","vx = 0","vy = 0","vz = 0"],librationPoint:"L1",librationPointOptions:["L1","L2"],family:null,errorValidationMessage:"",selectedFamilyLabel:null,familyOptions:[{label:"Горизонтальные орбиты Ляпунова, L1",value:"L1.L",allowFloke:!0},{label:"Горизонтальные орбиты Ляпунова, L2",value:"L2.L",allowFloke:!0},{label:"Вертикальные орбиты Ляпунова, L1",value:"L1.V",allowFloke:!0},{label:"Вертикальные орбиты Ляпунова, L2",value:"L2.V",allowFloke:!0},{label:"Гало орбиты, L1",value:"L1.H",allowFloke:!0},{label:"Гало орбиты, L2",value:"L2.H",allowFloke:!0},{label:"Двухпериодические квазигоризонтальные орбиты, L1",value:"L1.L.2P1",allowFloke:!0},{label:"Трехпериодические квазигоризонтальные орбиты, L1",value:"L1.L.3P1",allowFloke:!0},{label:"Четырехпериодические квазигоризонтальные орбиты, L1",value:"L1.L.4P1",allowFloke:!0},{label:"Четырехпериодические квазигоризонтальные орбиты, L1 (2P1.2P1)",value:"L1.L.2P1.2P1",allowFloke:!1},{label:"Шестипериодические квазигоризонтальные орбиты, L1 (2P1.3P1)",value:"L1.L.2P1.3P1",allowFloke:!1},{label:"Шестипериодические квазигоризонтальные орбиты, L1 (2P1.3P2)",value:"L1.L.2P1.3P2",allowFloke:!1},{label:"Шестипериодические квазигоризонтальные орбиты, L2 (2P1.3P1)",value:"L2.L.2P1.3P1",allowFloke:!1},{label:"Шестипериодические квазигоризонтальные орбиты, L2 (2P1.3P2)",value:"L2.L.2P1.3P2",allowFloke:!1},{label:"Трехпериодические квазигало орбиты, L2 (3P1)",value:"L2.H.3P1",allowFloke:!1},{label:"Двухпериодические квазигало орбиты, L1 (2P1)",value:"L1.H.2P1",allowFloke:!0},{label:"Двухпериодические квазигало орбиты, L1 (2P2)",value:"L1.H.2P2",allowFloke:!0},{label:"Двухпериодические квазигало орбиты, L1 (2P3)",value:"L1.H.2P3",allowFloke:!0},{label:"Двухпериодические квазигало орбиты, L2 (2P1)",value:"L2.H.2P1",allowFloke:!0},{label:"Двухпериодические квазигало орбиты, L2 (2P2)",value:"L2.H.2P2",allowFloke:!0},{label:"Трехпериодические квазигало орбиты, L1 (3P1)",value:"L1.H.3P1",allowFloke:!0},{label:"Трехпериодические квазигало орбиты, L1 (3P2)",value:"L1.H.3P2",allowFloke:!0},{label:"Трехпериодические квазигало орбиты, L1 (3P3)",value:"L1.H.3P3",allowFloke:!0},{label:"Четырехпериодические квазигало орбиты, L1",value:"L1.H.4P1",allowFloke:!0},{label:"Двухпериодические квазигоризонтальные орбиты, L2",value:"L2.L.2P1",allowFloke:!0},{label:"Трехпериодические квазигоризонтальные орбиты, L2",value:"L2.L.3P1 ",allowFloke:!0},{label:"Четырехпериодические квазигоризонтальные орбиты, L2 (4P1)",value:"L1.H.4P1",allowFloke:!0},{label:"Четырехпериодические квазигоризонтальные орбиты, L2 (2P1.2P1)",value:"L2.L.2P1.2P1",allowFloke:!0}]}},computed:{familyLabels(){return this.familyOptions.map((t=>t.label))},labelToValueMap(){return this.familyOptions.reduce(((t,e)=>(t[e.label]=e.value,t)),{})},filteredParamOptions(){if("График изменения параметра в семействе"===this.localSelectedOption&&this.selectedFamilyLabel){const t=this.familyOptions.find((t=>t.label===this.selectedFamilyLabel));if(t&&!t.allowFloke)return this.paramOptions.filter((t=>"Максимальный множитель Флоке"!==t))}return this.paramOptions}},methods:{formatNumber(t,e=2){if(null===t||void 0===t)return"0";const a=Number(t).toFixed(e);return a.replace(/[.,]0*$/,"")},parseCoordinate(t){const e=parseFloat(t);return isNaN(e)?0:e},validateInput(t,e){const a=t.target.value,i=a.replace(/[^0-9.-]/g,"");i!==a&&(this.localInputs[e]=i)},emitCoordinate(t){const e=this.parseCoordinate(this.localInputs[t]),a=this.orbitCoordinates[t];e!==a&&this.$emit("update-orbit-coordinates",{...this.orbitCoordinates,[t]:e})},validateError(){this.jacobiError>.01?(this.jacobiError=.01,this.errorValidationMessage="Погрешность не может быть больше 0,01"):this.errorValidationMessage=""},async buildGraph(){if(this.$emit("update:selectedOption",this.localSelectedOption),"Сечение Пуанкаре одной орбиты"===this.localSelectedOption)this.$emit("find-nearest-orbit"),this.$emit("update-poincare-plane",this.poincarePlane);else if("Орбита в 3D"===this.localSelectedOption||"Проекции орбиты"===this.localSelectedOption)this.$emit("find-nearest-orbit");else if("Сечение Пуанкаре с заданным значением константы Якоби"===this.localSelectedOption)this.$emit("build-poincare-section-with-cj",{librationPoint:this.librationPoint,cj:this.jacobiConstantLocal,d:this.jacobiError,plane:this.poincarePlane});else if("График изменения параметра в семействе"===this.localSelectedOption){if(!this.selectedFamilyLabel||!this.paramX||!this.paramY)return void alert("Пожалуйста, выберите семейство и параметры для осей X и Y");const t=this.labelToValueMap[this.selectedFamilyLabel];this.$emit("build-parameter-change-graph",{family:t,paramX:this.paramX,paramY:this.paramY})}else console.log("Неизвестная опция:",this.localSelectedOption)},checkAndResetParams(){this.selectedFamilyLabel&&!this.familyOptions.find((t=>t.label===this.selectedFamilyLabel&&t.allowFloke))&&("Максимальный множитель Флоке"===this.paramX&&(this.paramX=null),"Максимальный множитель Флоке"===this.paramY&&(this.paramY=null))}},watch:{selectedOption(t){this.localSelectedOption=t},localSelectedOption(t){this.$emit("update:selectedOption",t),"График изменения параметра в семействе"!==t?(this.paramX=null,this.paramY=null,this.selectedFamilyLabel=null):this.checkAndResetParams()},selectedFamilyLabel(){this.checkAndResetParams()},orbitCoordinates:{handler(t){this.localInputs.x=this.formatNumber(t.x),this.localInputs.z=this.formatNumber(t.z)},deep:!0},jacobiConstant(t){this.jacobiConstantLocal=t}}};const we=(0,h.A)(Xe,[["render",Ce],["__scopeId","data-v-a9f12468"]]);var je=we;const $e={class:"container"},ze={key:0,class:"loading-message"},De={key:1,class:"content"},Ne={class:"info-2"},Ee={key:0,class:"no-orbits-message"},Se={key:1,class:"loading-message"},Ye={key:2},Te={key:3,class:"no-orbits-message"};function Ve(t,e,a,i,l,r){const n=(0,o.g2)("PlotlyGraph");return(0,o.uX)(),(0,o.CE)("div",$e,[r.combinedIsLoading?((0,o.uX)(),(0,o.CE)("div",ze,e[0]||(e[0]=[(0,o.Lk)("div",{class:"spinner"},null,-1),(0,o.Lk)("p",null,"Загрузка данных графика...",-1)]))):((0,o.uX)(),(0,o.CE)("div",De,[(0,o.Lk)("div",Ne,[e[4]||(e[4]=(0,o.Lk)("h3",null,"Сечение Пуанкаре",-1)),(0,o.Lk)("div",null,[l.noOrbitInfoFound?((0,o.uX)(),(0,o.CE)("div",Ee,e[1]||(e[1]=[(0,o.Lk)("p",null,"К сожалению, данные графика орбиты не найдены.",-1)]))):l.trajectoryLoading?((0,o.uX)(),(0,o.CE)("div",Se,e[2]||(e[2]=[(0,o.Lk)("div",{class:"spinner"},null,-1),(0,o.Lk)("p",null,"Загрузка данных траектории...",-1)]))):l.orb4.length>0?((0,o.uX)(),(0,o.CE)("div",Ye,[(0,o.bF)(n,{dataPoints:l.orb4,plane:l.plane},null,8,["dataPoints","plane"])])):((0,o.uX)(),(0,o.CE)("div",Te,e[3]||(e[3]=[(0,o.Lk)("p",null," Не найдено сечение Пуанкаре с заданными параметрами. ",-1)])))])])]))])}const _e={ref:"plot",class:"plotly-graph"};function Ae(t,e,a,i,l,r){return(0,o.uX)(),(0,o.CE)("div",_e,null,512)}var Ue={props:{dataPoints:{type:Array,required:!0,default:()=>[]},plane:{type:String,required:!0,default:"x = 0"}},watch:{dataPoints:{handler(t){this.$nextTick((()=>{t.length>0?this.renderPlot():this.clearPlot()}))},deep:!0,immediate:!0},plane(){this.$nextTick((()=>{this.dataPoints.length>0&&this.renderPlot()}))}},mounted(){this.$nextTick((()=>{this.dataPoints.length>0&&this.renderPlot()}))},methods:{formatNumber(t,e=6){return 0===t?"0":t.toLocaleString(void 0,{minimumFractionDigits:e,maximumFractionDigits:e}).replace(/\.?0+$/,"")},renderPlot(){if(!this.$refs.plot)return void console.error("Ref 'plot' is not available.");const t={"x = 0":{x:"y",y:"z",titleX:"Y",titleY:"Z",unitX:"км",unitY:"км",scale:!0},"y = 0":{x:"x",y:"z",titleX:"X",titleY:"Z",unitX:"км",unitY:"км",scale:!0},"z = 0":{x:"x",y:"y",titleX:"X",titleY:"Y",unitX:"км",unitY:"км",scale:!0},"vx = 0":{x:"vy",y:"vz",titleX:"Vy",titleY:"Vz",unitX:"км/с",unitY:"км/с",scale:!1},"vy = 0":{x:"vx",y:"vz",titleX:"Vx",titleY:"Vz",unitX:"км/с",unitY:"км/с",scale:!1},"vz = 0":{x:"vx",y:"vy",titleX:"Vx",titleY:"Vy",unitX:"км/с",unitY:"км/с",scale:!1}},e=this.plane,a=t[e];if(!a)return void console.error(`Unknown plane: ${e}`);const i=a.scale,o=",.6~f",l=this.dataPoints.map((t=>({x:i?t[a.x]/1e3:t[a.x],y:i?t[a.y]/1e3:t[a.y],actualX:t.x,actualY:t.y,actualZ:t.z,vx:t.vx,vy:t.vy,vz:t.vz}))),r=l.map((t=>t.x)),n=l.map((t=>t.y)),s=l.map((t=>{let a=[];return"x = 0"!==e&&a.push(`X: ${this.formatNumber(t.actualX/1e3,6)} 10³ км`),"y = 0"!==e&&a.push(`Y: ${this.formatNumber(t.actualY/1e3,6)} 10³ км`),"z = 0"!==e&&a.push(`Z: ${this.formatNumber(t.actualZ/1e3,6)} 10³ км`),a.push(`Vx: ${this.formatNumber(t.vx,6)} км/с`),a.push(`Vy: ${this.formatNumber(t.vy,6)} км/с`),a.push(`Vz: ${this.formatNumber(t.vz,6)} км/с`),a.join("<br>")})),d=[{x:r,y:n,mode:"markers",type:"scatter",marker:{size:6,color:"blue"},text:s,hoverinfo:"text"}],c={title:`Сечение Пуанкаре (${e})`,xaxis:{title:`${a.titleX} (${i?"10³ ":""}${a.unitX})`,tickformat:o,exponentformat:"none",zeroline:!1,showgrid:!0},yaxis:{title:`${a.titleY} (${i?"10³ ":""}${a.unitY})`,tickformat:o,exponentformat:"none",zeroline:!1,showgrid:!0},showlegend:!1,width:700,height:500,hovermode:"closest"},u={displayModeBar:!1,responsive:!0};N().react(this.$refs.plot,d,c,u)},clearPlot(){this.$refs.plot?N().purge(this.$refs.plot):console.warn("Plot reference is not available for clearing.")}}};const Me=(0,h.A)(Ue,[["render",Ae],["__scopeId","data-v-3886c662"]]);var He=Me,Ze={components:{PlotlyGraph:He},props:{parentLoading:{type:Boolean,default:!1},poincarePlane:{type:String,default:"x = 0"}},data(){return{orb4:[],noOrbitInfoFound:!1,localLoading:!1,plane:this.poincarePlane||"x = 0",trajectoryLoading:!1}},computed:{...(0,E.L8)(["orbitId"]),combinedIsLoading(){return this.parentLoading||this.localLoading||this.trajectoryLoading}},watch:{orbitId(t){t?this.loadOrbitData(t):(this.noOrbitInfoFound=!0,this.resetData())},poincarePlane(t){this.plane=t||"x = 0",this.orbitId&&this.loadOrbitData(this.orbitId)}},mounted(){this.orbitId?this.loadOrbitData(this.orbitId):this.noOrbitInfoFound=!0},methods:{...(0,E.i0)(["cacheOrbitData"]),resetData(){this.orb4=[]},async loadOrbitData(t){console.log(`Загрузка данных орбиты с ID: ${t}`),this.localLoading=!0;try{console.log(`Запрос данных орбиты с ID: ${t}`);let e=await fetch(`https://orbital-catalog.auditory.ru/api/v1/orbits/${t}`,{method:"GET"});if(console.log(`Ответ на запрос орбиты: ${e.status}`),!e.ok)throw this.noOrbitInfoFound=!0,new Error("Failed to fetch orbit data");let a=await e.json();if(console.log("Полученные данные орбиты:",a),!a||!a.id)throw this.noOrbitInfoFound=!0,new Error("Invalid orbit data");this.noOrbitInfoFound=!1,console.log(`Запрос траектории для орбиты ID: ${a.id}`),this.trajectoryLoading=!0;let i=await fetch(`https://orbital-catalog.auditory.ru/api/v1/poincare_sections/${a.id}/${this.plane}`,{method:"GET"});console.log(`Ответ на запрос Poincaré секций: ${i.status}`);let o=[];if(i.ok){let t=await i.json();console.log("Полученные данные Poincaré секций:",t),o=t||[]}else console.error("Failed to fetch Poincaré sections data");0===o.length&&console.warn("Poincaré sections data is empty."),this.orb4=o}catch(e){console.error("NearestOrbitPoincare.vue: Ошибка при получении данных орбиты:",e),this.noOrbitInfoFound=!0,this.resetData()}finally{this.localLoading=!1,this.trajectoryLoading=!1}}}};const Be=(0,h.A)(Ze,[["render",Ve],["__scopeId","data-v-01c0ede7"]]);var qe=Be;const Ge={class:"container"},Je={key:0,class:"loading-message"},Re={key:1,class:"no-data-message"},Qe={key:2,class:"content"};function We(t,e,a,i,l,r){const n=(0,o.g2)("GraphForCj");return(0,o.uX)(),(0,o.CE)("div",Ge,[l.isLoading?((0,o.uX)(),(0,o.CE)("div",Je,e[0]||(e[0]=[(0,o.Lk)("div",{class:"spinner"},null,-1),(0,o.Lk)("p",null,"Загрузка данных...",-1)]))):l.dataPoints.length?((0,o.uX)(),(0,o.CE)("div",Qe,[e[2]||(e[2]=(0,o.Lk)("h3",null,"Сечение Пуанкаре с константой Якоби",-1)),(0,o.bF)(n,{dataPoints:l.dataPoints,plane:a.plane},null,8,["dataPoints","plane"])])):((0,o.uX)(),(0,o.CE)("div",Re,e[1]||(e[1]=[(0,o.Lk)("p",null,"Сечение Пуанкаре не найдено",-1)])))])}const Ke={ref:"plot",class:"plotly-graph"};function ta(t,e,a,i,l,r){return(0,o.uX)(),(0,o.CE)("div",Ke,null,512)}var ea={props:{dataPoints:{type:Array,required:!0,default:()=>[]},plane:{type:String,required:!0,default:"x = 0"}},watch:{dataPoints:{handler(t){this.$nextTick((()=>{t.length>0?this.renderPlot():this.clearPlot()}))},deep:!0,immediate:!0},plane(){this.$nextTick((()=>{this.dataPoints.length>0&&this.renderPlot()}))}},mounted(){this.$nextTick((()=>{this.dataPoints.length>0&&this.renderPlot()}))},methods:{formatNumber(t,e=6){return 0===t?"0":t.toLocaleString(void 0,{minimumFractionDigits:e,maximumFractionDigits:e}).replace(/\.?0+$/,"")},renderPlot(){if(!this.$refs.plot)return void console.error("Ref 'plot' is not available.");const t={"x = 0":{x:"y",y:"z",titleX:"Y",titleY:"Z",unitX:"км",unitY:"км",scale:!0},"y = 0":{x:"x",y:"z",titleX:"X",titleY:"Z",unitX:"км",unitY:"км",scale:!0},"z = 0":{x:"x",y:"y",titleX:"X",titleY:"Y",unitX:"км",unitY:"км",scale:!0},"vx = 0":{x:"vy",y:"vz",titleX:"Vy",titleY:"Vz",unitX:"км/с",unitY:"км/с",scale:!1},"vy = 0":{x:"vx",y:"vz",titleX:"Vx",titleY:"Vz",unitX:"км/с",unitY:"км/с",scale:!1},"vz = 0":{x:"vx",y:"vy",titleX:"Vx",titleY:"Vy",unitX:"км/с",unitY:"км/с",scale:!1}},e=this.plane||"x = 0",a=t[e];if(!a)return void console.error(`Unknown plane: ${e}`);const i="vx = 0"===e||"vy = 0"===e||"vz = 0"===e,o=this.dataPoints.map((t=>t.v.map((t=>({x:a.scale?t[a.x]/1e3:t[a.x],y:a.scale?t[a.y]/1e3:t[a.y],actualX:t.x,actualY:t.y,actualZ:t.z,vx:t.vx,vy:t.vy,vz:t.vz}))))),l=o.map(((t,a)=>{const i=t.map((t=>t.x)),o=t.map((t=>t.y)),l=t.map((t=>{let a=[];return["x = 0","y = 0","z = 0"].includes(e)?("x = 0"!==e&&a.push(`X: ${this.formatNumber(t.actualX/1e3)} 10³ км`),"y = 0"!==e&&a.push(`Y: ${this.formatNumber(t.actualY/1e3)} 10³ км`),"z = 0"!==e&&a.push(`Z: ${this.formatNumber(t.actualZ/1e3)} 10³ км`)):a.push(`X: ${this.formatNumber(t.actualX/1e3)} 10³ км`,`Y: ${this.formatNumber(t.actualY/1e3)} 10³ км`,`Z: ${this.formatNumber(t.actualZ/1e3)} 10³ км`),"vx = 0"!==e&&a.push(`Vx: ${this.formatNumber(t.vx,6)} км/с`),"vy = 0"!==e&&a.push(`Vy: ${this.formatNumber(t.vy,6)} км/с`),"vz = 0"!==e&&a.push(`Vz: ${this.formatNumber(t.vz,6)} км/с`),a.join("<br>")})),r=`hsl(${360*a/this.dataPoints.length}, 100%, 50%)`;return{x:i,y:o,mode:"markers",type:"scatter",name:`Орбита ${a+1}`,marker:{size:6,color:r},text:l,hoverinfo:"text"}})),r={title:`Сечение Пуанкаре (${e})`,xaxis:{title:`${a.titleX} (${a.unitX})`,tickformat:i?",.3~f":",.0~f",exponentformat:"none",zeroline:!1,showgrid:!0},yaxis:{title:`${a.titleY} (${a.unitY})`,tickformat:i?",.3~f":",.0~f",exponentformat:"none",zeroline:!1,showgrid:!0},showlegend:!1,width:700,height:500,hovermode:"closest"},n={displayModeBar:!1,responsive:!0};N().react(this.$refs.plot,l,r,n)},clearPlot(){this.$refs.plot?N().purge(this.$refs.plot):console.warn("Plot reference is not available for clearing.")}}};const aa=(0,h.A)(ea,[["render",ta],["__scopeId","data-v-3fa8b78a"]]);var ia=aa,oa={components:{GraphForCj:ia},props:{librationPoint:{type:String,required:!0},cj:{type:Number,default:1},d:{type:Number,default:1},plane:{type:String,default:"x = 0"}},data(){return{isLoading:!1,errorMessage:"",dataPoints:[]}},computed:{fetchParams(){return{librationPoint:this.librationPoint,cj:this.cj,d:this.d,plane:this.plane}}},watch:{fetchParams:{handler(){this.fetchData()},deep:!0,immediate:!0}},methods:{...(0,E.i0)(["cacheOrbitData"]),async fetchData(){this.isLoading=!0,this.errorMessage="",this.dataPoints=[];try{const t=await fetch(`https://orbital-catalog.auditory.ru/api/v1/poincare_sections/cj?libration_point=${encodeURIComponent(this.librationPoint)}&cj=${encodeURIComponent(this.cj||1)}&d=${encodeURIComponent(this.d||1)}&plane=${encodeURIComponent(this.plane||"x = 0")}`,{method:"GET"});if(!t.ok)throw new Error("Ошибка при загрузке данных");const e=await t.json();this.dataPoints=e||[]}catch(t){console.error("Error fetching data:",t),this.errorMessage=t.message}finally{this.isLoading=!1}}}};const la=(0,h.A)(oa,[["render",We],["__scopeId","data-v-37b5b5a6"]]);var ra=la;const na={class:"container"},sa={key:0,class:"loading-message"},da={key:1,class:"error-message"},ca={key:2,class:"no-data-message"},ua={key:3,class:"content"};function pa(t,e,a,i,l,r){const n=(0,o.g2)("GraphForParameterChange");return(0,o.uX)(),(0,o.CE)("div",na,[l.isLoading?((0,o.uX)(),(0,o.CE)("div",sa,e[0]||(e[0]=[(0,o.Lk)("div",{class:"spinner"},null,-1),(0,o.Lk)("p",null,"Загрузка данных...",-1)]))):l.errorMessage?((0,o.uX)(),(0,o.CE)("div",da,[(0,o.Lk)("p",null,(0,x.v_)(l.errorMessage),1)])):l.dataPoints&&0!==l.dataPoints.length?((0,o.uX)(),(0,o.CE)("div",ua,[(0,o.bF)(n,{dataPoints:l.dataPoints,paramX:a.paramX,paramY:a.paramY},null,8,["dataPoints","paramX","paramY"])])):((0,o.uX)(),(0,o.CE)("div",ca,e[1]||(e[1]=[(0,o.Lk)("p",null,"Данные не найдены или отсутствуют.",-1)])))])}const ha={key:0,class:"no-data-message"},ma={key:1,ref:"plot",class:"plotly-graph"};function ba(t,e,a,i,l,r){return(0,o.uX)(),(0,o.CE)("div",null,[a.dataPoints&&0!==a.dataPoints.length?((0,o.uX)(),(0,o.CE)("div",ma,null,512)):((0,o.uX)(),(0,o.CE)("div",ha,e[0]||(e[0]=[(0,o.Lk)("p",null,"Данные не найдены или отсутствуют.",-1)])))])}var fa={props:{dataPoints:{type:Array,required:!0},paramX:{type:String,required:!0},paramY:{type:String,required:!0}},watch:{dataPoints:{handler(){this.dataPoints&&this.dataPoints.length>0&&this.renderPlot()},deep:!0},paramX:"renderPlot",paramY:"renderPlot"},mounted(){this.dataPoints&&this.dataPoints.length>0&&this.renderPlot()},methods:{formatNumber(t,e=3){if(null===t||void 0===t||isNaN(t))return"N/A";if(0===t)return"0";const a=Math.abs(t);if(a>=1e9){const a=t/1e9;return`${a.toFixed(e).replace(/[.,]0*$/,"")} x10⁹`}if(a>=1e6){const a=t/1e6;return`${a.toFixed(e).replace(/[.,]0*$/,"")} x10⁶`}return t.toLocaleString(void 0,{minimumFractionDigits:e,maximumFractionDigits:e}).replace(/[.,]0*$/,"")},calculateStep(t,e){const a=t/e,i=Math.floor(Math.log10(a)),o=a/Math.pow(10,i);let l;return l=o<=1?1:o<=2?2:o<=5?5:10,l*Math.pow(10,i)},generateTickValues(t){if(!t||0===t.length)return{tickvals:[],ticktext:[]};const e=Math.min(...t),a=Math.max(...t),i=a-e;if(0===i)return{tickvals:[e],ticktext:[this.formatNumber(e)]};const o=5,l=this.calculateStep(i,o),r=Math.floor(e/l)*l,n=Math.ceil(a/l)*l,s=[],d=[];for(let c=r;c<=n;c+=l)s.push(c),d.push(this.formatNumber(c));return{tickvals:s,ticktext:d}},renderPlot(){if(!this.$refs.plot)return void console.error("Ref 'plot' is not available.");const t={"Период":{field:"t",unit:"дни",scale:1},"Амплитуда по X":{field:"ax",unit:"10³ км",scale:.001},"Амплитуда по Y":{field:"ay",unit:"10³ км",scale:.001},"Амплитуда по Z":{field:"az",unit:"10³ км",scale:.001},"Расстояние до Земли":{field:"dist_primary",unit:"10³ км",scale:.001},"Расстояние до Луны":{field:"dist_secondary",unit:"10³ км",scale:.001},"Константа Якоби":{field:"cj",unit:"",scale:1},"Максимальный множитель Флоке":{field:"max_floke",unit:"",scale:1}},e=t[this.paramX],a=t[this.paramY];if(!e||!a)return void console.error("Invalid parameter selected");const i=this.dataPoints.map((t=>t[e.field]*e.scale)),o=this.dataPoints.map((t=>t[a.field]*a.scale)),l=this.dataPoints.map((t=>{let i=[];const o=t[e.field]*e.scale,l=t[a.field]*a.scale;return i.push(`${this.paramX}: ${this.formatNumber(o)} ${e.unit}`),i.push(`${this.paramY}: ${this.formatNumber(l)} ${a.unit}`),i.join("<br>")})),r=[{x:i,y:o,mode:"markers",type:"scatter",marker:{size:6},text:l,hoverinfo:"text"}],{tickvals:n,ticktext:s}=this.generateTickValues(i),{tickvals:d,ticktext:c}=this.generateTickValues(o),u={xaxis:{title:`${this.paramX}${e.unit?` (${e.unit})`:""}`,tickvals:n,ticktext:s,showgrid:!0,automargin:!0},yaxis:{title:`${this.paramY}${a.unit?` (${a.unit})`:""}`,tickvals:d,ticktext:c,showgrid:!0,automargin:!0},showlegend:!1,width:700,height:500,hovermode:"closest",margin:{l:100,r:100,t:50,b:100}},p={displayModeBar:!1,responsive:!0};N().react(this.$refs.plot,r,u,p)}}};const va=(0,h.A)(fa,[["render",ba],["__scopeId","data-v-3705fd75"]]);var ya=va,La={components:{GraphForParameterChange:ya},props:{family:{type:String,required:!1},paramX:{type:String,required:!1},paramY:{type:String,required:!1}},data(){return{isLoading:!1,errorMessage:"",dataPoints:[]}},computed:{fetchParams(){return{family:this.family,paramX:this.paramX,paramY:this.paramY}}},watch:{fetchParams:{handler(){if(!this.fetchParams.family||!this.fetchParams.paramX||!this.fetchParams.paramY)return this.errorMessage="Пожалуйста, выберите семейство и параметры для осей X и Y",void(this.dataPoints=[]);this.fetchData()},deep:!0,immediate:!0}},methods:{async fetchData(){if(this.family&&this.paramX&&this.paramY){this.isLoading=!0,this.errorMessage="",this.dataPoints=[];try{const t=await fetch(`https://orbital-catalog.auditory.ru/api/v1/orbits/family/${encodeURIComponent(this.family)}`);if(!t.ok)throw new Error("Ошибка при загрузке данных");const e=await t.json();this.dataPoints=e||[]}catch(t){console.error("Error fetching data:",t),this.errorMessage=t.message}finally{this.isLoading=!1}}else this.errorMessage="Пожалуйста, выберите семейство и параметры для осей X и Y"}}};const ga=(0,h.A)(La,[["render",pa],["__scopeId","data-v-7ea17b3e"]]);var Pa=ga,ka={components:{OrbitInformationBuild:ie,OrbitProjections:fe,displayTypeBlock:je,NearestOrbitPoincare:qe,PoincareSectionWithCj:ra,ParameterChangeGraph:Pa},data(){return{orbitCoordinates:{x:0,y:0,z:0,vx:0,vy:0,vz:0},selectedOption:"Орбита в 3D",family:null,paramX:null,paramY:null,jacobiConstant:null,librationPoint:"L1",jacobiError:.01,orbitNotFound:!1,isLoading:!1,poincarePlane:null}},computed:{...(0,E.aH)(["orbitId","orbitCache","poincarePlane"]),orbitData(){return this.$store.getters.getOrbitData(this.orbitId)}},methods:{...(0,E.i0)(["updateOrbitId","cacheOrbitData","resetOrbitsData","resetOrbitCache"]),updateOrbitCoordinates(t){this.orbitCoordinates={...t}},updateFamily(t){this.family=t},updateJacobiConstant(t){this.jacobiConstant=t},async findNearestOrbit(){this.isLoading=!0;try{const{x:t,y:e,z:a,vx:i,vy:o,vz:l}=this.orbitCoordinates,r=await fetch(`https://orbital-catalog.auditory.ru/api/v1/trajectories/nearest?x=${t||0}&y=${e||0}&z=${a||0}&vx=${i||0}&vy=${o||0}&vz=${l||0}`),n=await r.json();if(console.log("API Response:",n),r.ok){if(void 0===n.orbit_id)throw new Error("Invalid response format from server");if(n.orbit_id===this.orbitId){const t=this.$store.getters.getOrbitData(this.orbitId);if(console.log("Stored Orbit Data:",t),t){if(Array.isArray(t.trajectory)){const e=t.trajectory[0]||{};this.orbitCoordinates={x:e.x||0,y:e.y||0,z:e.z||0,vx:e.vx||0,vy:e.vy||0,vz:e.vz||0}}else this.orbitCoordinates={x:t.trajectory?.x||0,y:t.trajectory?.y||0,z:t.trajectory?.z||0,vx:t.trajectory?.vx||0,vy:t.trajectory?.vy||0,vz:t.trajectory?.vz||0};this.updateOrbitCoordinates(this.orbitCoordinates)}}else this.updateOrbitId(n.orbit_id),this.orbitNotFound=!1,this.cacheOrbitData({id:n.orbit_id,orbitInfo:null,trajectory:n.v})}else{if(404!==r.status||"not found"!==n.detail)throw new Error("Error finding nearest orbit");this.updateOrbitId(null),this.orbitNotFound=!0}}catch(t){console.error("Error finding nearest orbit:",t),this.updateOrbitId(null),this.orbitNotFound=!0}finally{this.isLoading=!1,console.log(`buildPage.vue: Завершили поиск ближайшей орбиты для orbitId: ${this.orbitId}`)}},updatePoincareSections(t){this.poincareSections=t},updatePoincarePlane(t){this.poincarePlane=t},buildPoincareSectionWithCj(t){this.librationPoint=t.librationPoint,this.jacobiConstant=t.cj,this.jacobiError=t.d,this.poincarePlane=t.plane,this.selectedOption="Сечение Пуанкаре с заданным значением константы Якоби"},buildParameterChangeGraph(t){this.family=t.family,this.paramX=t.paramX,this.paramY=t.paramY,this.selectedOption="График изменения параметра в семействе"}},watch:{orbitId(t){t&&this.selectedOption,t&&this.selectedOption}},mounted(){this.orbitId||this.findNearestOrbit(),this.orbitId&&this.selectedOption,this.orbitId&&this.selectedOption}};const xa=(0,h.A)(ka,[["render",Ut],["__scopeId","data-v-775a0ec0"]]);var Oa=xa;const Fa=[{path:"/",name:"mainPage",component:Vt},{path:"/build",name:"buildPage",component:Oa}],Ia=(0,g.aE)({history:(0,g.Bt)("/"),routes:Fa});var Ca=Ia,Xa=(0,E.y$)({state:{selectedOrbit:0,informationOrbit:0,orbitId:null,orbits:{},filters:{amplitudeX:{from:null,to:null},period:{from:null,to:null},amplitudeY:{from:null,to:null},jacobiConstant:{from:null,to:null},amplitudeZ:{from:null,to:null},family:null},orbitCache:{},poincarePlane:"x = 0",allOrbitsData:[],selectedOrbitsData:null},mutations:{SET_ORBIT_ID(t,e){t.orbitId=e},CACHE_ORBIT_DATA(t,e){t.orbits[e.id]=e.orbitInfo||{},e.trajectory&&(t.orbits[e.id].x=e.trajectory.x,t.orbits[e.id].y=e.trajectory.y,t.orbits[e.id].z=e.trajectory.z,t.orbits[e.id].vx=e.trajectory.vx,t.orbits[e.id].vy=e.trajectory.vy,t.orbits[e.id].vz=e.trajectory.vz)},RESET_ORBITS_DATA(t){t.orbits={}},selectOrbit(t){t.selectedOrbit=1},infoOrbit(t){t.informationOrbit=1},resetInformationOrbit(t){t.informationOrbit=0},setOrbitId(t,e){t.orbitId=e},setPoincarePlane(t,e){t.poincarePlane=e},addOrbitToCache(t,{id:e,orbitInfo:a,trajectory:i}){t.orbitCache[e]={orbitInfo:a,trajectory:i}},addTrajectoryToCache(t,{id:e,trajectory:a}){t.orbitCache[e]||(t.orbitCache[e]={}),t.orbitCache[e].trajectory=a},addOrbitInfoToCache(t,{id:e,orbitInfo:a}){t.orbitCache[e]||(t.orbitCache[e]={}),t.orbitCache[e].orbitInfo=a},setFilter(t,{filterName:e,value:a}){t.filters[e]=a},setFamily(t,e){t.filters.family=e},setAllOrbitsData(t,e){t.allOrbitsData=e},setSelectedOrbitsData(t,e){t.selectedOrbitsData=e},setSelectedOrbitId(t,e){t.selectedOrbitId=e},resetOrbitsData(t){t.allOrbitsData=[],t.selectedOrbitsData=null}},actions:{updateOrbitId({commit:t},e){t("setOrbitId",e)},updateFilter({commit:t},{filterName:e,value:a}){t("setFilter",{filterName:e,value:a})},updateFamily({commit:t},e){t("setFamily",e)},cacheOrbitData({commit:t},e){t("addOrbitToCache",e)},cacheTrajectoryData({commit:t},e){t("addTrajectoryToCache",e)},cacheOrbitInfo({commit:t},e){t("addOrbitInfoToCache",e)},resetOrbitsData({commit:t}){t("resetOrbitsData")}},getters:{orbitId:t=>t.orbitId,filters:t=>t.filters,getOrbitData:t=>e=>t.orbitCache?t.orbitCache[e]:void 0,getOrbitInfo:t=>e=>t.orbitCache[e]?.orbitInfo||null,getTrajectory:t=>e=>t.orbitCache[e]?.trajectory||null,allOrbitsData:t=>t.allOrbitsData,selectedOrbitsData:t=>t.selectedOrbitsData}});(0,i.Ef)(y).use(Xa).use(Ca).mount("#app")}},e={};function a(i){var o=e[i];if(void 0!==o)return o.exports;var l=e[i]={exports:{}};return t[i](l,l.exports,a),l.exports}a.m=t,function(){var t=[];a.O=function(e,i,o,l){if(!i){var r=1/0;for(c=0;c<t.length;c++){i=t[c][0],o=t[c][1],l=t[c][2];for(var n=!0,s=0;s<i.length;s++)(!1&l||r>=l)&&Object.keys(a.O).every((function(t){return a.O[t](i[s])}))?i.splice(s--,1):(n=!1,l<r&&(r=l));if(n){t.splice(c--,1);var d=o();void 0!==d&&(e=d)}}return e}l=l||0;for(var c=t.length;c>0&&t[c-1][2]>l;c--)t[c]=t[c-1];t[c]=[i,o,l]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var i in e)a.o(e,i)&&!a.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){a.p="/"}(),function(){var t={524:0};a.O.j=function(e){return 0===t[e]};var e=function(e,i){var o,l,r=i[0],n=i[1],s=i[2],d=0;if(r.some((function(e){return 0!==t[e]}))){for(o in n)a.o(n,o)&&(a.m[o]=n[o]);if(s)var c=s(a)}for(e&&e(i);d<r.length;d++)l=r[d],a.o(t,l)&&t[l]&&t[l][0](),t[l]=0;return a.O(c)},i=self["webpackChunkmiem_project"]=self["webpackChunkmiem_project"]||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}();var i=a.O(void 0,[504],(function(){return a(601)}));i=a.O(i)})();